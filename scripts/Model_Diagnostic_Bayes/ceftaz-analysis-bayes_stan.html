<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paulina Okuńska (okunskapaul@gmail.com)">
<meta name="author" content="Pawel Wiczling">
<meta name="dcterms.date" content="2026-01-19">

<title>Pharmacokinetics of ceftolozane with tazobactam in critically ill patients - Bayesian approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ceftaz-analysis-bayes_stan_files/libs/clipboard/clipboard.min.js"></script>
<script src="ceftaz-analysis-bayes_stan_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="ceftaz-analysis-bayes_stan_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="ceftaz-analysis-bayes_stan_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="ceftaz-analysis-bayes_stan_files/libs/quarto-html/popper.min.js"></script>
<script src="ceftaz-analysis-bayes_stan_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ceftaz-analysis-bayes_stan_files/libs/quarto-html/anchor.min.js"></script>
<link href="ceftaz-analysis-bayes_stan_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ceftaz-analysis-bayes_stan_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ceftaz-analysis-bayes_stan_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ceftaz-analysis-bayes_stan_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ceftaz-analysis-bayes_stan_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#settings" id="toc-settings" class="nav-link active" data-scroll-target="#settings">Settings</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#stan" id="toc-stan" class="nav-link" data-scroll-target="#stan">Stan</a></li>
  </ul></li>
  <li><a href="#diagnostics-from-cmdstanr" id="toc-diagnostics-from-cmdstanr" class="nav-link" data-scroll-target="#diagnostics-from-cmdstanr">Diagnostics from cmdstanr</a>
  <ul class="collapse">
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables">Tables</a></li>
  <li><a href="#mcmc" id="toc-mcmc" class="nav-link" data-scroll-target="#mcmc">MCMC</a></li>
  <li><a href="#shrinkage" id="toc-shrinkage" class="nav-link" data-scroll-target="#shrinkage">Shrinkage</a></li>
  <li><a href="#etas-vs.-covariates" id="toc-etas-vs.-covariates" class="nav-link" data-scroll-target="#etas-vs.-covariates">ETAS vs.&nbsp;covariates</a></li>
  <li><a href="#eta-correlation" id="toc-eta-correlation" class="nav-link" data-scroll-target="#eta-correlation">ETA correlation</a></li>
  <li><a href="#prior-vs-posterior-params" id="toc-prior-vs-posterior-params" class="nav-link" data-scroll-target="#prior-vs-posterior-params">Prior vs posterior params</a></li>
  <li><a href="#individual-and-population-predictions" id="toc-individual-and-population-predictions" class="nav-link" data-scroll-target="#individual-and-population-predictions">individual and population predictions</a></li>
  </ul></li>
  <li><a href="#vpc" id="toc-vpc" class="nav-link" data-scroll-target="#vpc">VPC</a></li>
  <li><a href="#gof" id="toc-gof" class="nav-link" data-scroll-target="#gof">GOF</a></li>
  <li><a href="#pta" id="toc-pta" class="nav-link" data-scroll-target="#pta">PTA</a>
  <ul class="collapse">
  <li><a href="#pta-plots" id="toc-pta-plots" class="nav-link" data-scroll-target="#pta-plots">PTA plots</a>
  <ul class="collapse">
  <li><a href="#pta-of-both-drugs" id="toc-pta-of-both-drugs" class="nav-link" data-scroll-target="#pta-of-both-drugs">PTA of both drugs</a></li>
  <li><a href="#pta-in-different-time-of-infusion" id="toc-pta-in-different-time-of-infusion" class="nav-link" data-scroll-target="#pta-in-different-time-of-infusion">PTA in different time of infusion</a></li>
  <li><a href="#pta-by-dose-and-time-of-infusion" id="toc-pta-by-dose-and-time-of-infusion" class="nav-link" data-scroll-target="#pta-by-dose-and-time-of-infusion">PTA by dose and time of infusion</a></li>
  </ul></li>
  <li><a href="#cmt" id="toc-cmt" class="nav-link" data-scroll-target="#cmt">1CMT</a>
  <ul class="collapse">
  <li><a href="#generate-parameter-sets" id="toc-generate-parameter-sets" class="nav-link" data-scroll-target="#generate-parameter-sets">Generate parameter sets</a></li>
  </ul></li>
  <li><a href="#pta-plots-1" id="toc-pta-plots-1" class="nav-link" data-scroll-target="#pta-plots-1">PTA plots</a>
  <ul class="collapse">
  <li><a href="#pta-of-3g-drugs-by-type-of-analysis" id="toc-pta-of-3g-drugs-by-type-of-analysis" class="nav-link" data-scroll-target="#pta-of-3g-drugs-by-type-of-analysis">PTA of 3g drugs by type of analysis</a></li>
  <li><a href="#pta-in-tinf-12h-by-type-of-analysis" id="toc-pta-in-tinf-12h-by-type-of-analysis" class="nav-link" data-scroll-target="#pta-in-tinf-12h-by-type-of-analysis">PTA in tinf = 12h by type of analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bootstrap" id="toc-bootstrap" class="nav-link" data-scroll-target="#bootstrap">Bootstrap</a>
  <ul class="collapse">
  <li><a href="#cmt-1" id="toc-cmt-1" class="nav-link" data-scroll-target="#cmt-1">1CMT</a>
  <ul class="collapse">
  <li><a href="#summary-of-parameter-estimates" id="toc-summary-of-parameter-estimates" class="nav-link" data-scroll-target="#summary-of-parameter-estimates">Summary of parameter estimates:</a></li>
  <li><a href="#generate-parameter-sets-1" id="toc-generate-parameter-sets-1" class="nav-link" data-scroll-target="#generate-parameter-sets-1">Generate parameter sets</a></li>
  <li><a href="#params-table" id="toc-params-table" class="nav-link" data-scroll-target="#params-table">Params table</a></li>
  </ul></li>
  <li><a href="#pta-final-plots" id="toc-pta-final-plots" class="nav-link" data-scroll-target="#pta-final-plots">PTA final plots</a>
  <ul class="collapse">
  <li><a href="#pta-in-tinf-8h-by-type-of-analysis" id="toc-pta-in-tinf-8h-by-type-of-analysis" class="nav-link" data-scroll-target="#pta-in-tinf-8h-by-type-of-analysis">PTA in tinf = 8h by type of analysis</a></li>
  <li><a href="#pta-in-tinf-12h-by-type-of-analysis-1" id="toc-pta-in-tinf-12h-by-type-of-analysis-1" class="nav-link" data-scroll-target="#pta-in-tinf-12h-by-type-of-analysis-1">PTA in tinf = 12h by type of analysis</a></li>
  </ul></li>
  <li><a href="#cmt-2" id="toc-cmt-2" class="nav-link" data-scroll-target="#cmt-2">2CMT</a>
  <ul class="collapse">
  <li><a href="#summary-of-parameter-estimates-1" id="toc-summary-of-parameter-estimates-1" class="nav-link" data-scroll-target="#summary-of-parameter-estimates-1">Summary of parameter estimates:</a></li>
  <li><a href="#generate-parameter-sets-2" id="toc-generate-parameter-sets-2" class="nav-link" data-scroll-target="#generate-parameter-sets-2">Generate parameter sets</a></li>
  <li><a href="#params-table-1" id="toc-params-table-1" class="nav-link" data-scroll-target="#params-table-1">Params table</a></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info">Session Info</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="ceftaz-analysis-bayes_stan.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pharmacokinetics of ceftolozane with tazobactam in critically ill patients - Bayesian approach</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Paulina Okuńska (okunskapaul@gmail.com) </p>
             <p>Pawel Wiczling </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 19, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Introduction</strong></p>
<p>Comprehensive Bayesian model analysis of population pharmacokinetics of ceftolozane/tazobactam. This script includes analyses of MCMC chains, assessments of model goodness-of-fit, and probability of target attainment (PTA) analyses comparing a one-compartment covariance model, a one-compartment bootstrap model, and a two-compartment Bayesian model.</p>
<p>piors based on: Larson, K. B. et al.&nbsp;Ceftolozane-Tazobactam Population Pharmacokinetics and Dose Selection for Further Clinical Evaluation in Pediatric Patients with Complicated Urinary Tract or Complicated Intra-Abdominal Infections. https://doi.org/10</p>
<section id="settings" class="level2">
<h2 class="anchored" data-anchor-id="settings">Settings</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">renv.config.dependencies.limit =</span> <span class="cn">Inf</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">status</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>This project does not appear to be using renv.
Use `renv::init()` to initialize the project.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">echo =</span> <span class="cn">TRUE</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">eval =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbr)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bbr.bayes)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrgsolve)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mrggsave)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vpc)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pmplots)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stable)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(whisker)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pmplots)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pmtables) </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nmrec)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co">#library(posterior)</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(yaml)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr) </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simpar)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MESS)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PKNCA)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(posterior))</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># conflicts</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"summarize"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"as.data.frame"</span>, <span class="st">"base"</span>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"sd"</span>, <span class="st">"posterior"</span>)</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"mad"</span>, <span class="st">"posterior"</span>)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"rhat"</span>, <span class="st">"posterior"</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="fu">set_cmdstan_path</span>(<span class="st">"D:/Torsten-master/cmdstan"</span>)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="co"># helper functions</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts/helpers/functions-table.R"</span>))</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts/helpers/functions-plots.R"</span>))</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts/helpers/functions-mcmc-diagnostics.R"</span>))</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts/helpers/functions-diagnostics-rhat-ess.R"</span>))</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts/helpers/resampling_functions.R"</span>))</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co"># table summary </span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>sigfun <span class="ot">=</span> <span class="cf">function</span>(.x){<span class="fu">sig</span>(.x,<span class="at">digits=</span><span class="dv">3</span>)}</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> <span class="st">"ceftaz-analysis-bayes_stan.qmd"</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>thisScript <span class="ot">&lt;-</span> params<span class="sc">$</span>script</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrg.script =</span> params<span class="sc">$</span>script,</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">mrggsave.dev =</span> <span class="st">"pdf,png"</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#directory</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"derived"</span>) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>model_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model"</span>,<span class="st">"BAYES"</span>)  </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>figure_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"deliv"</span>,<span class="st">"figures"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>table_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"deliv"</span>,<span class="st">"tables"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>figure_mcmc_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"MCMC"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>thisFigDir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(figure_mcmc_dir, params<span class="sc">$</span>run)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mrggsave.dir =</span> thisFigDir)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="fu">here</span>(<span class="st">"scripts/helpers/helper_model_diagnostic.R"</span>))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(figure_mcmc_dir)) <span class="fu">dir.create</span>(figure_mcmc_dir)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>cmdstanr<span class="sc">::</span><span class="fu">check_cmdstan_toolchain</span>()</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#bbr</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">bbr.bbi_exe_path =</span> <span class="st">"C:/Users/pauoku/AppData/Roaming/bbi/bbi.exe"</span>) <span class="do">### need to be changed to your directory</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>bbr<span class="sc">::</span><span class="fu">use_bbi</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Installing bbi on a windows system
────────────────────────────────────────────────────────────────────────────────
 - Installed Version: 3.4.0  - Current release: 3.4.0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bbi_init</span>(<span class="at">.dir =</span> model_dir,            <span class="co"># the directory to create the bbi.yaml in</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">.nonmem_dir =</span> <span class="st">"C:/"</span>,         <span class="co"># location of NONMEM installation</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.nonmem_version =</span> <span class="st">"nm75g64"</span>,  <span class="co"># default NONMEM version to use</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">.bbi_args =</span> <span class="fu">list</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">threads =</span> <span class="dv">4</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#       mpi_exec_path ="C:/nm75g64/run/psexec",</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       parafile = "C:/nm75g64/run/fpiwini8.pnm",</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>this_theme <span class="ot">&lt;-</span> pmplots<span class="sc">::</span><span class="fu">pm_theme</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(this_theme)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>Load data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>xdata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(data_dir, <span class="st">"/"</span>, <span class="st">"RawData.csv"</span>, <span class="at">na.strings =</span> <span class="st">"."</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(xdata)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  ID NUM TIME DV  AMT RATE ADDL II CMT MDV EVID HEIGHT  BW SEX AGE SOFA   PCT
1  1   1  0.0  0 2000 2000    2  8   1   1    1    180 150   1  46   13 12.55
2  1   2  0.0  0 1000 1000    2  8   3   1    1    180 150   1  46   13 12.55
3  1   3  0.0  0    0    0    0  0   1   1    2    180 150   1  46   13 12.55
4  1   4  0.0  0    0    0    0  0   3   1    2    180 150   1  46   13 12.55
5  1   5  0.2  0    0    0    0  0   1   1    2    180 150   1  46   13 12.55
6  1   6  0.2  0    0    0    0  0   3   1    2    180 150   1  46   13 12.55
  ECMO CRRT ELWI    CI  CRE ALB PROTEIN
1    1    1   17 2.815 2.36 2.7    5.71
2    1    1   17 2.815 2.36 2.7    5.71
3    1    1   17 2.815 2.36 2.7    5.71
4    1    1   17 2.815 2.36 2.7    5.71
5    1    1   17 2.815 2.36 2.7    5.71
6    1    1   17 2.815 2.36 2.7    5.71</code></pre>
</div>
</div>
<section id="stan" class="level2">
<h2 class="anchored" data-anchor-id="stan">Stan</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod5  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(<span class="fu">file.path</span>(model_dir, params<span class="sc">$</span>run))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mod5</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<p>── Status ─────────────────────────────────</p>
<p>• Finished Running</p>
<p>── Absolute Model Path ───────────────────────────</p>
<p>• D:/PROJECTS/ceftolozane-tazobactam/model/BAYES/5</p>
<p>── YAML &amp; Model Files ───────────────────────────</p>
<p>• D:/PROJECTS/ceftolozane-tazobactam/model/BAYES/5.yaml</p>
<p>• D:/PROJECTS/ceftolozane-tazobactam/model/BAYES/5/5.stan</p>
<p>• D:/PROJECTS/ceftolozane-tazobactam/model/BAYES/5/5-standata.R</p>
<p>• D:/PROJECTS/ceftolozane-tazobactam/model/BAYES/5/5-init.R</p>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mod5_res <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(mod5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</section>
</section>
<section id="diagnostics-from-cmdstanr" class="level1">
<h1>Diagnostics from cmdstanr</h1>
<section id="tables" class="level2">
<h2 class="anchored" data-anchor-id="tables">Tables</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"CLCHat"</span>, <span class="st">"QCHat"</span>, <span class="st">"V1CHat"</span>, <span class="st">"V2CHat"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"CLTHat"</span>, <span class="st">"QTHat"</span>, <span class="st">"V1THat"</span>, <span class="st">"V2THat"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"omega"</span>, <span class="st">"sigma"</span>,<span class="st">"nu"</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ptable <span class="ot">&lt;-</span> mod5_res<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(pars)) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">formatC</span>(., <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parameter =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"90% CI"</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"("</span>, q5, <span class="st">", "</span>, q95, <span class="st">")"</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">"90% CI"</span>, ess_bulk, ess_tail, rhat)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>ptable</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 9
   parameter mean    median sd     mad    `90% CI`      ess_bulk  ess_tail rhat 
   &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;
 1 lp__      "-3.05" -2.7   10.1   10.1   (-19.8, 13.2) "1.25e+0… 2.22e+03 "   …
 2 CLCHat    "5.79"  5.74   0.709  0.692  (4.71, 7.06)  " 832"    1.47e+03 "1.0…
 3 QCHat     "2.67"  2.58   0.717  0.67   (1.69, 3.95)  "5.78e+0… 3.15e+03 "   …
 4 V1CHat    "22.4"  22.3   2.81   2.73   (17.7,   27)  "1.91e+0… 2.34e+03 "   …
 5 V2CHat    "4.41"  4.28   1.15   1.09   (2.81, 6.51)  "6.28e+0… 3.12e+03 "   …
 6 CLTHat    "15.4"  15.2   1.72   1.66   (12.8, 18.4)  "1.81e+0… 2.61e+03 "   …
 7 QTHat     "4.55"  4.43   1.15   1.13   (2.92, 6.64)  "5.82e+0… 3.09e+03 "   …
 8 V1THat    "  36"  35.9   5.37   5.42   (27.2,   45)  "2.16e+0… 2.9e+03  "   …
 9 V2THat    "5.26"  5.11   1.29   1.26   (3.44, 7.56)  "6.4e+03" 2.17e+03 "   …
10 omega[1]  "0.471" 0.464  0.0711 0.0667 (0.366,  0.6) "1.82e+0… 2.41e+03 "   …
# ℹ 11 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pars1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CLCHat"</span>, <span class="st">"QCHat"</span>, <span class="st">"V1CHat"</span>, <span class="st">"V2CHat"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"CLTHat"</span>, <span class="st">"QTHat"</span>, <span class="st">"V1THat"</span>, <span class="st">"V2THat"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"omega"</span>, <span class="st">"sigma"</span>, <span class="st">"nu"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>thetas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CLCHat"</span>, <span class="st">"QCHat"</span>, <span class="st">"V1CHat"</span>, <span class="st">"V2CHat"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"CLTHat"</span>, <span class="st">"QTHat"</span>, <span class="st">"V1THat"</span>, <span class="st">"V2THat"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>rest   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"omega[1]"</span>, <span class="st">"omega[2]"</span>, <span class="st">"omega[3]"</span>, <span class="st">"omega[4]"</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"omega[5]"</span>, <span class="st">"omega[6]"</span>, <span class="st">"omega[7]"</span>, <span class="st">"omega[8]"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"sigma[1]"</span>, <span class="st">"sigma[2]"</span>, <span class="st">"nu[1]"</span>, <span class="st">"nu[2]"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>theta_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"CLC"</span>, <span class="st">"QC"</span>, <span class="st">"V1C"</span>, <span class="st">"V2C"</span>, <span class="st">"CLT"</span>, <span class="st">"QT"</span>, <span class="st">"V1T"</span>, <span class="st">"V2T"</span>) </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>ptable_all <span class="ot">&lt;-</span> mod5_res<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(pars1)) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">formatC</span>(., <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parameter =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">90% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, q5, <span class="st">", "</span>, q95, <span class="st">")"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">`</span><span class="at">90% CI</span><span class="st">`</span>, rhat)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>gtGreek <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CLC"</span>, <span class="st">"QC"</span>, <span class="st">"V1C"</span>, <span class="st">"V2C"</span>, <span class="st">"CLT"</span>, <span class="st">"QT"</span>, <span class="st">"V1T"</span>, <span class="st">"V2T"</span>) <span class="sc">~</span> </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">theta_{</span><span class="sc">\\</span><span class="st">text{"</span>, text, <span class="st">"}}"</span>),</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">==</span> <span class="st">"omega"</span> <span class="sc">~</span> <span class="st">"</span><span class="sc">\\</span><span class="st">Omega"</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="st">"</span><span class="sc">\\</span><span class="st">Sigma"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">==</span> <span class="st">"nu"</span>    <span class="sc">~</span> <span class="st">"</span><span class="sc">\\</span><span class="st">nu"</span>,</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> text)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>mathMode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="st">"$"</span>, x, <span class="st">"$"</span>)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>formatGreekNames <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is_theta =</span> <span class="fu">str_ends</span>(parameter, <span class="st">"Hat$"</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">base =</span> <span class="fu">if_else</span>(is_theta, <span class="fu">str_remove</span>(parameter, <span class="st">"Hat$"</span>), parameter)) <span class="sc">%&gt;%</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">greek =</span> <span class="fu">mathMode</span>(<span class="fu">gtGreek</span>(base))) <span class="sc">%&gt;%</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">parameter =</span> greek,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>           mean, median, sd, mad, <span class="st">`</span><span class="at">90% CI</span><span class="st">`</span>, rhat)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>ptable1_greek <span class="ot">&lt;-</span> ptable_all <span class="sc">%&gt;%</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">%in%</span> thetas) <span class="sc">%&gt;%</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatGreekNames</span>()</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>ptable2_greek <span class="ot">&lt;-</span> ptable_all <span class="sc">%&gt;%</span></span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">%in%</span> rest) <span class="sc">%&gt;%</span></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatGreekNames</span>()</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ptable1_greek, ptable2_greek) <span class="sc">%&gt;%</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">!</span><span class="fu">str_detect</span>(parameter, <span class="st">"Omega|Sigma|nu"</span>), parameter)</span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>footAbbrev <span class="ot">&lt;-</span> <span class="st">"Abbreviations: SD = standard deviation; MAD = Median Absolute Deviation; CI = confidence intervals; R-hat = Gelman–Rubin convergence diagnostic"</span></span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>fixed <span class="ot">&lt;-</span> param_df <span class="sc">%&gt;%</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_center</span>(<span class="at">desc =</span> <span class="fu">col_ragged</span>(<span class="fl">6.5</span>), <span class="at">abb =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_rename</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"mean"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"median"</span>, <span class="st">"SD"</span> <span class="ot">=</span> <span class="st">"sd"</span>, <span class="st">"MAD"</span> <span class="ot">=</span> <span class="st">"mad"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_blank</span>(<span class="st">"abb"</span>, <span class="st">"greek"</span>, <span class="st">"desc"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_files</span>(<span class="at">r =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_notes</span>(footAbbrev) <span class="sc">%&gt;%</span></span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_noteconf</span>(<span class="at">type =</span> <span class="st">"minipage"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_image</span>()</span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>fixed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/parameters%20tables-1.png" class="img-fluid figure-img" width="304"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ptable_rest <span class="ot">&lt;-</span> mod5_res<span class="sc">$</span><span class="fu">summary</span>(rest) <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">formatC</span>(., <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parameter =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">90% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, q5, <span class="st">", "</span>, q95, <span class="st">")"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">`</span><span class="at">90% CI</span><span class="st">`</span>, rhat) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">base =</span> <span class="fu">str_extract</span>(parameter, <span class="st">"^[a-z]+"</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">index =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(parameter, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>)),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">index_text =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"omega"</span> <span class="sc">~</span> theta_names[index],</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"sigma"</span>, index),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"nu"</span>    <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"nu"</span>, index)),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">parameter =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"omega"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">Omega_{</span><span class="sc">\\</span><span class="st">text{"</span>, index_text, <span class="st">"}}$"</span>),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">Sigma_{"</span>, index, <span class="st">"}$"</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"nu"</span>    <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">nu_{"</span>,    index, <span class="st">"}$"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>base, <span class="sc">-</span>index, <span class="sc">-</span>index_text)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>rests <span class="ot">&lt;-</span> ptable_rest <span class="sc">%&gt;%</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_center</span>(<span class="at">desc =</span> <span class="fu">col_ragged</span>(<span class="fl">6.0</span>), <span class="at">abb =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_rename</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"mean"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"median"</span>, <span class="st">"SD"</span> <span class="ot">=</span> <span class="st">"sd"</span>, <span class="st">"MAD"</span> <span class="ot">=</span> <span class="st">"mad"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_blank</span>(<span class="st">"abb"</span>, <span class="st">"greek"</span>, <span class="st">"desc"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_files</span>(<span class="at">r =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_notes</span>(footAbbrev) <span class="sc">%&gt;%</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_noteconf</span>(<span class="at">type =</span> <span class="st">"minipage"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_image</span>()</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>rests</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/parameters%20tables-2.png" class="img-fluid figure-img" width="304"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>theta_params <span class="ot">&lt;-</span> thetas</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>omega_sigma_params <span class="ot">&lt;-</span> rest[<span class="fu">str_detect</span>(rest, <span class="st">"omega|sigma"</span>)]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>other_params <span class="ot">&lt;-</span> rest[<span class="fu">str_detect</span>(rest, <span class="st">"nu"</span>)]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sigma_params <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"sigma[1]"</span>, <span class="st">"sigma[2]"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>footAbbrev <span class="ot">&lt;-</span> <span class="st">"Abbreviations: SD = standard deviation; MAD = Median Absolute Deviation; CI = confidence intervals; R-hat = Gelman–Rubin convergence diagnostic"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, pars1)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>draws <span class="ot">&lt;-</span> mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits=</span><span class="dv">2</span>) <span class="fu">round</span>(x, digits)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ptable_all <span class="ot">&lt;-</span> <span class="fu">summarise_draws</span>(</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  draws,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  mean,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  median,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  sd,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  mad,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2.5  =</span> <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="fl">0.025</span>),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5    =</span> <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="fl">0.05</span>),</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">q95   =</span> <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="fl">0.95</span>),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">q97.5 =</span> <span class="sc">~</span><span class="fu">quantile</span>(.x, <span class="fl">0.975</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  ess_bulk,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  ess_tail,</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  rhat) <span class="sc">%&gt;%</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parameter =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>     <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(mean <span class="sc">!=</span> <span class="dv">0</span>, (sd <span class="sc">/</span> mean) <span class="sc">*</span> <span class="dv">100</span>, <span class="cn">NA_real_</span>),    </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV%</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> omega_sigma_params <span class="sc">&amp;</span> mean <span class="sc">!=</span> <span class="dv">0</span>, (sd <span class="sc">/</span> mean) <span class="sc">*</span> <span class="dv">100</span>, <span class="cn">NA_real_</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params, <span class="fu">formatC</span>(<span class="st">`</span><span class="at">%RSE</span><span class="st">`</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="cn">NA_character_</span>),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV%</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> omega_sigma_params, <span class="fu">formatC</span>(<span class="st">`</span><span class="at">CV%</span><span class="st">`</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>), <span class="cn">NA_character_</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean  =</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params, <span class="fu">formatC</span>(mean,  <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">formatC</span>(mean,  <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">median=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params, <span class="fu">formatC</span>(median, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">formatC</span>(median, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd    =</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params, <span class="fu">formatC</span>(sd, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">formatC</span>(sd, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">mad   =</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params, <span class="fu">formatC</span>(mad, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">formatC</span>(mad, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>)),</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span><span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params, <span class="fu">formatC</span>(<span class="st">`</span><span class="at">%RSE</span><span class="st">`</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span>),</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV%</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> omega_sigma_params, <span class="fu">formatC</span>(<span class="st">`</span><span class="at">CV%</span><span class="st">`</span>, <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">`</span><span class="at">CV%</span><span class="st">`</span>),</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params,</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> sigma_params, </span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>))),</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">5%</span><span class="st">`</span>    <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> sigma_params,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>))),</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95%</span><span class="st">`</span>   <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">95%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> sigma_params,</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">95%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">95%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>))),</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> theta_params,</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(parameter <span class="sc">%in%</span> sigma_params,</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">4</span>),</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">3</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"2.5%"</span>, <span class="st">"97.5%"</span>), </span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>                  <span class="sc">~</span><span class="fu">if_else</span>(parameter <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sigma[1]"</span>, <span class="st">"sigma[2]"</span>),</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">formatC</span>(<span class="fu">as.numeric</span>(.), <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">4</span>), .))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">90% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="st">`</span><span class="at">5%</span><span class="st">`</span>, <span class="st">", "</span>, <span class="st">`</span><span class="at">95%</span><span class="st">`</span>, <span class="st">")"</span>),</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="st">`</span><span class="at">2.5%</span><span class="st">`</span>, <span class="st">", "</span>, <span class="st">`</span><span class="at">97.5%</span><span class="st">`</span>, <span class="st">")"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ess_bulk =</span> <span class="fu">round</span>(ess_bulk, <span class="dv">0</span>), <span class="at">ess_tail =</span> <span class="fu">round</span>(ess_tail,<span class="dv">0</span>), <span class="at">rhat =</span> <span class="fu">round</span>(rhat, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span>, <span class="st">`</span><span class="at">CV%</span><span class="st">`</span>,  <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, ess_bulk, ess_tail, rhat) <span class="co">#`90% CI`,</span></span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>gtGreek <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">case_when</span>(</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CLC"</span>, <span class="st">"QC"</span>, <span class="st">"V1C"</span>, <span class="st">"V2C"</span>, <span class="st">"CLT"</span>, <span class="st">"QT"</span>, <span class="st">"V1T"</span>, <span class="st">"V2T"</span>) <span class="sc">~</span> </span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">theta_{</span><span class="sc">\\</span><span class="st">text{"</span>, text, <span class="st">"}}"</span>),</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">==</span> <span class="st">"omega"</span> <span class="sc">~</span> <span class="st">"</span><span class="sc">\\</span><span class="st">Omega"</span>,</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="st">"</span><span class="sc">\\</span><span class="st">Sigma"</span>,</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">==</span> <span class="st">"nu"</span>    <span class="sc">~</span> <span class="st">"</span><span class="sc">\\</span><span class="st">nu"</span>,</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> text</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>mathMode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(<span class="st">"$"</span>, x, <span class="st">"$"</span>)</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>formatGreekNames <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is_theta =</span> <span class="fu">str_ends</span>(parameter, <span class="st">"Hat$"</span>),</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>           <span class="at">base =</span> <span class="fu">if_else</span>(is_theta, <span class="fu">str_remove</span>(parameter, <span class="st">"Hat$"</span>), parameter)) <span class="sc">%&gt;%</span></span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">greek =</span> <span class="fu">mathMode</span>(<span class="fu">gtGreek</span>(base))) <span class="sc">%&gt;%</span></span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">parameter =</span> greek,</span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>           mean, median, sd, mad, <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span>, <span class="st">`</span><span class="at">CV%</span><span class="st">`</span>,  <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, ess_bulk, ess_tail, rhat) <span class="co">#`90% CI`,</span></span>
<span id="cb15-93"><a href="#cb15-93" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-94"><a href="#cb15-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" aria-hidden="true" tabindex="-1"></a>ptable1_greek <span class="ot">&lt;-</span> ptable_all <span class="sc">%&gt;%</span></span>
<span id="cb15-96"><a href="#cb15-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">%in%</span> thetas) <span class="sc">%&gt;%</span></span>
<span id="cb15-97"><a href="#cb15-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatGreekNames</span>()</span>
<span id="cb15-98"><a href="#cb15-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-99"><a href="#cb15-99" aria-hidden="true" tabindex="-1"></a>ptable2_greek <span class="ot">&lt;-</span> ptable_all <span class="sc">%&gt;%</span></span>
<span id="cb15-100"><a href="#cb15-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">%in%</span> rest) <span class="sc">%&gt;%</span></span>
<span id="cb15-101"><a href="#cb15-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatGreekNames</span>()</span>
<span id="cb15-102"><a href="#cb15-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-103"><a href="#cb15-103" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ptable1_greek, ptable2_greek) <span class="sc">%&gt;%</span></span>
<span id="cb15-104"><a href="#cb15-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">!</span><span class="fu">str_detect</span>(parameter, <span class="st">"Omega|Sigma|nu"</span>), parameter)</span>
<span id="cb15-105"><a href="#cb15-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-106"><a href="#cb15-106" aria-hidden="true" tabindex="-1"></a>fixed <span class="ot">&lt;-</span> param_df <span class="sc">%&gt;%</span></span>
<span id="cb15-107"><a href="#cb15-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-108"><a href="#cb15-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_center</span>(<span class="at">desc =</span> <span class="fu">col_ragged</span>(<span class="fl">6.5</span>), <span class="at">abb =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-109"><a href="#cb15-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_rename</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"mean"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"median"</span>, <span class="st">"SD"</span> <span class="ot">=</span> <span class="st">"sd"</span>, <span class="st">"MAD"</span> <span class="ot">=</span> <span class="st">"mad"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-110"><a href="#cb15-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_blank</span>(<span class="st">"abb"</span>, <span class="st">"greek"</span>, <span class="st">"desc"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-111"><a href="#cb15-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_files</span>(<span class="at">r =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-112"><a href="#cb15-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_notes</span>(footAbbrev) <span class="sc">%&gt;%</span></span>
<span id="cb15-113"><a href="#cb15-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_noteconf</span>(<span class="at">type =</span> <span class="st">"minipage"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-114"><a href="#cb15-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-115"><a href="#cb15-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_image</span>()</span>
<span id="cb15-116"><a href="#cb15-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-117"><a href="#cb15-117" aria-hidden="true" tabindex="-1"></a>fixed </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/add%2095CI-1.png" class="img-fluid figure-img" width="304"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ptable_rest <span class="ot">&lt;-</span> ptable_all <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">%in%</span> rest) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">base =</span> <span class="fu">str_extract</span>(parameter, <span class="st">"^[a-z]+"</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">index =</span> <span class="fu">as.numeric</span>(<span class="fu">str_extract</span>(parameter, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>)),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">index_text =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"omega"</span> <span class="sc">~</span> theta_names[index],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"sigma"</span>, index),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"nu"</span>    <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"nu"</span>, index)),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">parameter =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"omega"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">Omega_{</span><span class="sc">\\</span><span class="st">text{"</span>, index_text, <span class="st">"}}$"</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"sigma"</span> <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">Sigma_{"</span>, index, <span class="st">"}$"</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>           base <span class="sc">==</span> <span class="st">"nu"</span>    <span class="sc">~</span> <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">nu_{"</span>,    index, <span class="st">"}$"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">`</span><span class="at">%RSE</span><span class="st">`</span>,<span class="st">`</span><span class="at">CV%</span><span class="st">`</span>,  <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, rhat) <span class="co">#`90% CI`,</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>rests <span class="ot">&lt;-</span> ptable_rest <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_center</span>(<span class="at">desc =</span> <span class="fu">col_ragged</span>(<span class="fl">6.0</span>), <span class="at">abb =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_rename</span>(<span class="st">"Mean"</span> <span class="ot">=</span> <span class="st">"mean"</span>, <span class="st">"Median"</span> <span class="ot">=</span> <span class="st">"median"</span>, <span class="st">"SD"</span> <span class="ot">=</span> <span class="st">"sd"</span>, <span class="st">"MAD"</span> <span class="ot">=</span> <span class="st">"mad"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_blank</span>(<span class="st">"abb"</span>, <span class="st">"greek"</span>, <span class="st">"desc"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_files</span>(<span class="at">r =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_notes</span>(footAbbrev) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_noteconf</span>(<span class="at">type =</span> <span class="st">"minipage"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_image</span>()</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>rests</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/add%2095CI-2.png" class="img-fluid figure-img" width="304"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pars2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"lp__"</span>, <span class="st">"rho"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ptable <span class="ot">&lt;-</span> mod5_res<span class="sc">$</span><span class="fu">summary</span>(<span class="fu">c</span>(pars2)) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="sc">~</span><span class="fu">formatC</span>(., <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">parameter =</span> variable) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"90% CI"</span> <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">"("</span>, q5, <span class="st">", "</span>, q95, <span class="st">")"</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(parameter, mean, median, sd, mad, <span class="st">"90% CI"</span>, ess_bulk, ess_tail, rhat)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>ptable</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 65 × 9
   parameter mean       median     sd     mad   `90% CI` ess_bulk ess_tail rhat 
   &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;
 1 lp__      "-3.05"    "-2.7"     "10.1" "10.… (-19.8,… "1.25e+… "2.22e+… "   …
 2 rho[1,1]  "   1"     "   1"     "   0" "   … (   1, … "  NA"   "  NA"   "  N…
 3 rho[2,1]  "-0.0155"  "-0.0149"  "0.19… "0.2… (-0.342… "6.45e+… "2.86e+… "   …
 4 rho[3,1]  "0.171"    "0.174"    "0.16… "0.1… (-0.097… "2.79e+… "3.18e+… "   …
 5 rho[4,1]  "0.0305"   "0.0329"   "0.19… "0.1… (-0.286… "5.5e+0… "2.45e+… "   …
 6 rho[5,1]  "0.265"    "0.272"    "0.15… "0.1… (-0.000… "3.47e+… "2.86e+… "   …
 7 rho[6,1]  "0.000133" "-0.00071" "0.18… "0.1… (-0.309… "6.91e+… "2.8e+0… "   …
 8 rho[7,1]  "0.173"    "0.176"    "0.15… "0.1… (-0.087… "2.66e+… "2.6e+0… "   …
 9 rho[8,1]  "0.0245"   "0.0265"   "0.18… "0.1… (-0.292… "7.48e+… "3.08e+… "   …
10 rho[1,2]  "-0.0155"  "-0.0149"  "0.19… "0.2… (-0.342… "6.45e+… "2.86e+… "   …
# ℹ 55 more rows</code></pre>
</div>
</div>
</section>
<section id="mcmc" class="level2">
<h2 class="anchored" data-anchor-id="mcmc">MCMC</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"mix-blue-red"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars)) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">10</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-4.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars)) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-5.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-6.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">10</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-7.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_dens_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-8.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace_highlight</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars)) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-9.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace_highlight</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-10.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace_highlight</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">10</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-11.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace_highlight</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-12.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_rank_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars)) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-13.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_rank_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-14.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_rank_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">10</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-15.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_rank_overlay</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">11</span><span class="sc">:</span><span class="dv">12</span>])) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/trace-plots-16.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="fu">ggtitle</span>(<span class="st">"Posterior distributions"</span>,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"with medians and 80% intervals"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesplot::mcmc_areas(mod5_res$draws(pars[1]),prob = 0.8) + plot_title + legend_move("bottom")</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesplot::mcmc_areas(mod5_res$draws(pars[2:5]),prob = 0.8) + plot_title + legend_move("bottom")</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesplot::mcmc_areas(mod5_res$draws(pars[6:9]),prob = 0.8) + plot_title + legend_move("bottom")</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesplot::mcmc_areas(mod5_res$draws(pars[10]),prob = 0.8) + plot_title + legend_move("bottom")</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesplot::mcmc_areas(mod5_res$draws(pars[11]),prob = 0.8) + plot_title + legend_move("bottom")</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesplot::mcmc_areas(mod5_res$draws(pars[12]),prob = 0.8) + plot_title + legend_move("bottom")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="fu">ggtitle</span>(<span class="st">"Posterior distributions"</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"with medians and 80% intervals"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">1</span>]),<span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span> plot_title <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"lp__"</span> <span class="ot">=</span> <span class="fu">expression</span>(lp)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/mcm%20areas-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]),<span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span> plot_title <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CLCHat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[CLC]), </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"QCHat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[QC]),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"V1CHat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[V1C]),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"V2CHat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[V2C])),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">t</span>(<span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"CLCHat"</span>, <span class="st">"QCHat"</span>, <span class="st">"V1CHat"</span>,  <span class="st">"V2CHat"</span> ))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/mcm%20areas-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">6</span><span class="sc">:</span><span class="dv">9</span>]),<span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span> plot_title <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CLTHat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[CLT]),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"QTHat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[QT]),</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"V1THat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[V1T]),</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"V2THat"</span> <span class="ot">=</span> <span class="fu">expression</span>(theta[V2T])),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">t</span>(<span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"CLTHat"</span>, <span class="st">"QTHat"</span>, <span class="st">"V1THat"</span>,  <span class="st">"V2THat"</span> ))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/mcm%20areas-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">10</span>]),<span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span> plot_title <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"omega[1]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[CLC]), </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[2]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[QC]),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[3]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[V1C]),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[4]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[V2C]),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[5]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[CLT]),</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[6]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[QT]),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[7]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[V1T]),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"omega[8]"</span> <span class="ot">=</span> <span class="fu">expression</span>(omega[V2T])), </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">t</span>(<span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"omega[1]"</span>,<span class="st">"omega[2]"</span>,<span class="st">"omega[3]"</span>,<span class="st">"omega[4]"</span>,<span class="st">"omega[5]"</span>,<span class="st">"omega[6]"</span>,<span class="st">"omega[7]"</span>,<span class="st">"omega[8]"</span>))))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/mcm%20areas-4.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">11</span>]),<span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span> plot_title <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sigma[1]"</span> <span class="ot">=</span> <span class="fu">expression</span>(sigma[C]),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"sigma[2]"</span> <span class="ot">=</span> <span class="fu">expression</span>(sigma[T])),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">limits =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"sigma[1]"</span>, <span class="st">"sigma[2]"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/mcm%20areas-5.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(pars[<span class="dv">12</span>]),<span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span> plot_title <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"nu[1]"</span> <span class="ot">=</span> <span class="fu">expression</span>(nu[C]),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"nu[2]"</span> <span class="ot">=</span> <span class="fu">expression</span>(nu[T])),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">"nu[1]"</span>, <span class="st">"nu[2]"</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/mcm%20areas-6.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="shrinkage" class="level2">
<h2 class="anchored" data-anchor-id="shrinkage">Shrinkage</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>etas <span class="ot">&lt;-</span>  posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"etaM"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"eta"</span>), <span class="sc">~</span><span class="fu">log</span>(.x)))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">#errors &lt;-  posterior::as_draws_df(mod_to_plot$draws("errors"))</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>bbr.bayes<span class="sc">::</span><span class="fu">shrinkage</span>(etas,<span class="st">"etaM"</span>,<span class="at">group_idx =</span> <span class="dv">1</span>, <span class="at">use_sd =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.334402 91.889476  9.699804 77.705992  2.134020 97.305293  6.629240
[8] 76.997091</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bbr.bayes::shrinkage(errors,"errors", use_sd = TRUE)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="etas-vs.-covariates" class="level2">
<h2 class="anchored" data-anchor-id="etas-vs.-covariates">ETAS vs.&nbsp;covariates</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>etaM <span class="ot">&lt;-</span> <span class="fu">extract_etas_fun</span>(mod5_res,xdata)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>model_figures_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"deliv"</span>, <span class="st">"figures"</span>, <span class="st">"BAYES"</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>cont_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"AGE//Age,y"</span>,<span class="st">"BW//Body Weight, kg"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>cat_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"SEX//Sex"</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">map</span>(cont_cov, \(x) <span class="fu">fun_cont_cov</span>(x,etaM))</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">map</span>(cat_cov, \(x) <span class="fu">fun_cat_cov</span>(x,etaM))</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">c</span>(p1, p2)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>plots</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/covariets%20vs%20etas-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/covariets%20vs%20etas-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/covariets%20vs%20etas-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(plots), \(x) <span class="fu">ggsave</span>(<span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(model_figures_dir, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                                 glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"cov-plots-{x}.png"</span>)),</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">plot =</span> plots[[x]], </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">width=</span><span class="dv">12</span>, <span class="at">height=</span><span class="dv">10</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">dpi=</span><span class="dv">600</span>, <span class="at">units=</span><span class="st">"cm"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "D:/PROJECTS/ceftolozane-tazobactam/deliv/figures/BAYES/cov-plots-1.png"

[[2]]
[1] "D:/PROJECTS/ceftolozane-tazobactam/deliv/figures/BAYES/cov-plots-2.png"

[[3]]
[1] "D:/PROJECTS/ceftolozane-tazobactam/deliv/figures/BAYES/cov-plots-3.png"</code></pre>
</div>
</div>
</section>
<section id="eta-correlation" class="level2">
<h2 class="anchored" data-anchor-id="eta-correlation">ETA correlation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> etaM  <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"V1C"</span>, <span class="st">"V1T"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">names_from =</span> <span class="st">"type"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> medianInd_V1C, <span class="at">y =</span> medianInd_V1T))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> etaM  <span class="sc">%&gt;%</span> </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CLC"</span>, <span class="st">"CLT"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">names_from =</span> <span class="st">"type"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> medianInd_CLC, <span class="at">y =</span> medianInd_CLT))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>t1 <span class="sc">+</span> t2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/ETA%20corr-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>etaM  <span class="sc">%&gt;%</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CLC"</span>, <span class="st">"CLT"</span>, <span class="st">"V1C"</span>, <span class="st">"V1T"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">names_from =</span> <span class="st">"type"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs_plot</span>(<span class="fu">c</span>(<span class="st">"medianInd_CLC//CLC"</span>, <span class="st">"medianInd_CLT//CLT"</span>, <span class="st">"medianInd_V1C//V1C"</span>,<span class="st">"medianInd_V1T//V1T"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/ETA%20corr-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="prior-vs-posterior-params" class="level2">
<h2 class="anchored" data-anchor-id="prior-vs-posterior-params">Prior vs posterior params</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>modx  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, <span class="st">"6"</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>mod_to_plot1 <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(modx)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>modx  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, <span class="st">"5"</span>))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>mod_to_plot2 <span class="ot">&lt;-</span> <span class="fu">read_fit_model</span>(modx)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"CLCHat"</span>, <span class="st">"QCHat"</span>, <span class="st">"V1CHat"</span>, <span class="st">"V2CHat"</span>, <span class="st">"CLTHat"</span>, <span class="st">"QTHat"</span>, <span class="st">"V1THat"</span>, <span class="st">"V2THat"</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot1<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(mod_to_plot2<span class="sc">$</span><span class="fu">draws</span>(pars))</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>p1_data <span class="ot">=</span> p1<span class="sc">$</span>plot<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"prior"</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>p2_data <span class="ot">=</span> p2<span class="sc">$</span>plot<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"posterior"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p1_data,p2_data)<span class="sc">%&gt;%</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>type, <span class="at">x=</span>m))<span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#4A2C2A"</span>)<span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> l, <span class="at">xmax =</span> h), <span class="at">size=</span><span class="dv">1</span>,<span class="at">color =</span> <span class="st">"#4A2C2A"</span>)<span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">xmax =</span> hh),<span class="at">color =</span> <span class="st">"#4A2C2A"</span>)<span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter, <span class="at">scales=</span><span class="st">"free_x"</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>plot1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/prior%20vs%20posterior-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>res_both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p1_data,p2_data) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"parameter"</span>, <span class="st">"ll"</span>, <span class="st">"m"</span>, <span class="st">"hh"</span>, <span class="st">"type"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>res_both</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
   parameter    ll     m    hh type     
   &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
 1 CLCHat     3.88  5.87  8.98 prior    
 2 CLCHat     4.71  5.74  7.06 posterior
 3 QCHat      1.69  2.54  3.82 prior    
 4 QCHat      1.69  2.58  3.95 posterior
 5 V1CHat     7.1  10.7  15.9  prior    
 6 V1CHat    17.7  22.3  27    posterior
 7 V2CHat     2.86  4.26  6.3  prior    
 8 V2CHat     2.81  4.28  6.51 posterior
 9 CLTHat    13.7  20.7  31.0  prior    
10 CLTHat    12.8  15.2  18.4  posterior
11 QTHat      2.69  4.06  6.11 prior    
12 QTHat      2.92  4.43  6.64 posterior
13 V1THat     8.57 12.9  19.3  prior    
14 V1THat    27.2  35.9  45.0  posterior
15 V2THat     3.36  5.05  7.66 prior    
16 V2THat     3.44  5.11  7.56 posterior</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>theta_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">CLCHat =</span> <span class="st">"theta[CLC]"</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">QCHat  =</span> <span class="st">"theta[QC]"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">V1CHat =</span> <span class="st">"theta[V1C]"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">V2CHat =</span> <span class="st">"theta[V2C]"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CLTHat =</span> <span class="st">"theta[CLT]"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">QTHat  =</span> <span class="st">"theta[QT]"</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">V1THat =</span> <span class="st">"theta[V1T]"</span>,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">V2THat =</span> <span class="st">"theta[V2T]"</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(p1_data, p2_data) <span class="sc">%&gt;%</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> theta_labels[parameter], <span class="at">parameter =</span> <span class="fu">factor</span>(parameter, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"theta[CLC]"</span>, <span class="st">"theta[QC]"</span>, <span class="st">"theta[V1C]"</span>, <span class="st">"theta[V2C]"</span>, <span class="st">"theta[CLT]"</span>, <span class="st">"theta[QT]"</span>, <span class="st">"theta[V1T]"</span>, <span class="st">"theta[V2T]"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> type, <span class="at">x =</span> m)) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#4A2C2A"</span>) <span class="sc">+</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> l, <span class="at">xmax =</span> h), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#4A2C2A"</span>) <span class="sc">+</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> ll, <span class="at">xmax =</span> hh), <span class="at">color =</span> <span class="st">"#4A2C2A"</span>) <span class="sc">+</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">labeller =</span> label_parsed)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>plot2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/prior%20vs%20posterior-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="individual-and-population-predictions" class="level2">
<h2 class="anchored" data-anchor-id="individual-and-population-predictions">individual and population predictions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior predictive checks</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>title_cef <span class="ot">&lt;-</span> <span class="st">"CEFTOLOZANE"</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>title_taz <span class="ot">&lt;-</span> <span class="st">"TAZOBACTAM"</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>yrepCond1 <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"cCond"</span>))) <span class="co">#individual</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>yrepPred1 <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"cPred"</span>))) <span class="co">#population</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>yobs <span class="ot">&lt;-</span> xdata<span class="sc">$</span>DV </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>yobs[yobs<span class="sc">==</span><span class="dv">0</span>] <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> xdata<span class="sc">$</span>TIME  </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>patientID <span class="ot">&lt;-</span> xdata<span class="sc">$</span>ID   </span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co">#CEF </span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"orange"</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># within patient predictions</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> (xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>cef1 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals_grouped</span>(<span class="at">y =</span> yobs[ktore], </span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">yrep =</span> yrepCond1[, ktore], </span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> time[ktore], </span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>                                 patientID[ktore])<span class="sc">+</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(title_cef) <span class="sc">+</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"TIME, h"</span>, </span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Individual Predicted Concentration, ug/mL"</span>) <span class="sc">+</span> </span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>, <span class="fl">0.1</span>), </span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="st">"grey95"</span>, <span class="at">size =</span> <span class="fl">0.5</span>)) </span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>cef1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/Indiv-pop-stan-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for new patient</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> (xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>cef2 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals_grouped</span>(<span class="at">y =</span> yobs[ktore], </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">yrep =</span> yrepPred1[, ktore], </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> time[ktore], </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                                 patientID[ktore])<span class="sc">+</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(title_cef) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"TIME, h"</span>, </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Population Predicted Concentration, ug/mL"</span>) <span class="sc">+</span> </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>, <span class="fl">0.1</span>), </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="st">"grey95"</span>, <span class="at">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>cef2 </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/Indiv-pop-stan-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TAZ</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"blue"</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># within patient predictions</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> (xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">3</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>taz1 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals_grouped</span>(<span class="at">y =</span> yobs[ktore], </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">yrep =</span> yrepCond1[, ktore], </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> time[ktore], </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                                 patientID[ktore])<span class="sc">+</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(title_taz) <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"TIME, h"</span>, </span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Individual Predicted concentration, ug/mL"</span>) <span class="sc">+</span> </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>, <span class="fl">0.1</span>), </span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="st">"grey95"</span>, <span class="at">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>taz1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/Indiv-pop-stan-3.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predictions for new patient</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> (xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>taz2 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals_grouped</span>(<span class="at">y =</span> yobs[ktore], </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">yrep =</span> yrepPred1[, ktore], </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> time[ktore], </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                                 patientID[ktore])<span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">300</span>)) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(title_taz) <span class="sc">+</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"TIME, h"</span>, </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">"Population Predicted concentration, ug/mL"</span>) <span class="sc">+</span> </span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">85</span>, <span class="fl">0.1</span>), </span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">color =</span> <span class="st">"grey95"</span>, <span class="at">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>taz2 </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/Indiv-pop-stan-4.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Combine both types of predictions</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>predInd <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"cCond"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cCond"</span>),</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">name =</span> forcats<span class="sc">::</span>fct_inorder)) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbInd =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianInd =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">ubInd =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>predPop <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"cPred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cPred"</span>),</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">name =</span> forcats<span class="sc">::</span>fct_inorder)) <span class="sc">%&gt;%</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">lbPop =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">medianPop =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">ubPop =</span> <span class="fu">quantile</span>(value, <span class="at">probs =</span> <span class="fl">0.95</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>predAll <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(xdata, predInd, predPop) <span class="sc">%&gt;%</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DV =</span> <span class="fu">if_else</span>(EVID<span class="sc">==</span><span class="dv">0</span>,DV, <span class="cn">NA</span>))</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="co">#CEF</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>ppc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(predAll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CMT <span class="sc">==</span> <span class="dv">1</span>), </span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> DV)) <span class="sc">+</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> medianPop, </span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"population"</span>) ) <span class="sc">+</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lbPop, <span class="at">ymax =</span> ubPop, </span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"population"</span>), </span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> medianInd, </span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"individual"</span>) ) <span class="sc">+</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lbInd, <span class="at">ymax =</span> ubInd, </span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"individual"</span>), </span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name  =</span><span class="st">"prediction:"</span>,</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"individual"</span>, <span class="st">"population"</span>),</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7A2525"</span>, <span class="st">"#1F3A6B"</span>)) <span class="sc">+</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name  =</span><span class="st">"prediction:"</span>,</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"individual"</span>, <span class="st">"population"</span>),</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7A2525"</span>, <span class="st">"#1F3A6B"</span>)) <span class="sc">+</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, h"</span>,</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Ceftolozane plasma drug concentration, ug/mL"</span>) <span class="sc">+</span></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID)</span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a><span class="co">#TAZ</span></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>ppt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(predAll <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CMT <span class="sc">==</span> <span class="dv">3</span>), </span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> DV)) <span class="sc">+</span></span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> medianPop, </span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"population"</span>) ) <span class="sc">+</span></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lbPop, <span class="at">ymax =</span> ubPop, </span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"population"</span>), </span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> medianInd, </span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"individual"</span>) ) <span class="sc">+</span></span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lbInd, <span class="at">ymax =</span> ubInd, </span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> <span class="st">"individual"</span>), </span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name  =</span><span class="st">"prediction:"</span>,</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"individual"</span>, <span class="st">"population"</span>),</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7A2525"</span>, <span class="st">"#1F3A6B"</span>)) <span class="sc">+</span></span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name  =</span><span class="st">"prediction:"</span>,</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"individual"</span>, <span class="st">"population"</span>),</span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7A2525"</span>, <span class="st">"#1F3A6B"</span>)) <span class="sc">+</span></span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, h"</span>,</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tazobactam plasma drug concentration, ug/mL"</span>) <span class="sc">+</span></span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb61-81"><a href="#cb61-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> ID)</span>
<span id="cb61-82"><a href="#cb61-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-83"><a href="#cb61-83" aria-hidden="true" tabindex="-1"></a>ppc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PREDICION-stan-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ppt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PREDICION-stan-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="vpc" class="level1">
<h1>VPC</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>nPost <span class="ot">&lt;-</span> mod5_res<span class="sc">$</span><span class="fu">metadata</span>()<span class="sc">$</span>iter_sampling <span class="sc">/</span> mod5_res<span class="sc">$</span><span class="fu">metadata</span>()<span class="sc">$</span>thin</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>predPop <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"cPred"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cPred"</span>),</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">name =</span> forcats<span class="sc">::</span>fct_inorder)) <span class="sc">%&gt;%</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>ID, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">TIME =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>TIME, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">CMT =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>CMT, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">EVID =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>EVID, n_chains <span class="sc">*</span> nPost),</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">DV =</span> <span class="fu">rep</span>(xdata<span class="sc">$</span>DV, n_chains <span class="sc">*</span> nPost))</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>CMT_labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"CEFTOLOZANE"</span>, <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"TAZOBACTAM"</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>vpcPlotraw <span class="ot">&lt;-</span> <span class="fu">vpc</span>(<span class="at">sim =</span> predPop <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DV)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EVID<span class="sc">==</span><span class="dv">0</span>),</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">obs =</span> xdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DV)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EVID<span class="sc">==</span><span class="dv">0</span>),</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">obs_cols =</span> <span class="fu">list</span>(<span class="at">id =</span> <span class="st">"ID"</span>, <span class="at">dv =</span> <span class="st">"DV"</span>, <span class="at">idv =</span> <span class="st">"TIME"</span>),</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">sim_cols =</span> <span class="fu">list</span>(<span class="at">is =</span> <span class="st">"ID"</span>, <span class="at">dv =</span> <span class="st">"value"</span>, <span class="at">idv =</span> <span class="st">"TIME"</span>),</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">ci =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="at">pi =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">stratify =</span> <span class="st">"CMT"</span>,</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">CMT =</span> CMT_labs),</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>               <span class="at">show =</span> <span class="fu">list</span>(<span class="at">obs_dv =</span> <span class="cn">FALSE</span>, <span class="at">obs_ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pi =</span> <span class="cn">FALSE</span>, <span class="at">pi_as_area =</span> <span class="cn">FALSE</span>, <span class="at">pi_ci =</span> <span class="cn">TRUE</span>, </span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">obs_median =</span> <span class="cn">TRUE</span>, <span class="at">sim_median =</span> <span class="cn">FALSE</span>, <span class="at">sim_median_ci =</span> <span class="cn">TRUE</span>),</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">vpc_theme =</span> <span class="fu">new_vpc_theme</span>(<span class="at">update =</span> <span class="fu">list</span>(</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_pi_fill =</span> <span class="st">"#1A2B1A"</span>,</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_pi_alpha =</span> <span class="fl">0.25</span>,</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_ci_size =</span> <span class="dv">1</span>,</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_ci_color =</span> <span class="st">"#1A2B1A"</span>,</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_median_color =</span> <span class="st">"#1A2B1A"</span>,</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs_ci_linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_median_fill =</span> <span class="st">"#1A2B1A"</span>,</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sim_median_alpha =</span> <span class="fl">0.5</span>)))<span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>vpcPlot <span class="ot">&lt;-</span> vpcPlotraw <span class="sc">+</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> xdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(DV)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(EVID<span class="sc">==</span><span class="dv">0</span>) , <span class="fu">aes</span>(<span class="at">x =</span> TIME, <span class="at">y =</span> DV), <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time, h"</span>,</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Plasma Drug Concentration, ug/mL"</span>) <span class="sc">+</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>vpcPlot</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/VPC-stan-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"brightblue"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>yrepCond1 <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"cCond"</span>))) <span class="co">#individual</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>yrepPred1 <span class="ot">&lt;-</span> <span class="fu">as_draws_matrix</span>(mod5_res<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"cPred"</span>))) <span class="co">#population</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>yobs <span class="ot">&lt;-</span> xdata<span class="sc">$</span>DV </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> (xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> xdata<span class="sc">$</span>EVID<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>cefind <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> yobs[ktore], <span class="at">yrep =</span> yrepCond1[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ktore], <span class="at">adjust =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">260</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CEFTOLOZANE"</span>, <span class="at">subtitle =</span> <span class="st">"Individual Predictions"</span>) </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>cefpop <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> yobs[ktore], <span class="at">yrep =</span> yrepPred1[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ktore], <span class="at">adjust =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">260</span>) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Population Predictions"</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> (xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">3</span> <span class="sc">&amp;</span> xdata<span class="sc">$</span>EVID<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>tazind <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> yobs[ktore], <span class="at">yrep =</span> yrepCond1[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ktore], <span class="at">adjust =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">70</span>) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"TAZOBACTAM"</span>, <span class="at">subtitle =</span> <span class="st">"Individual Predictions"</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>tazpop <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> yobs[ktore], <span class="at">yrep =</span> yrepPred1[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ktore], <span class="at">adjust =</span> <span class="dv">6</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">70</span>) <span class="sc">+</span> <span class="fu">legend_move</span>(<span class="st">"bottom"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"Population Predictions"</span>)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>cefall <span class="ot">&lt;-</span> cefind <span class="sc">+</span> cefpop <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>cefall</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/ppc_dens_overlay-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>tazall <span class="ot">&lt;-</span> tazind <span class="sc">+</span> tazpop <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>) <span class="sc">&amp;</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>tazall</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/ppc_dens_overlay-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gof" class="level1">
<h1>GOF</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"teal"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a> yobs <span class="ot">&lt;-</span> xdata<span class="sc">$</span>DV</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a> ktore <span class="ot">&lt;-</span> xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> xdata<span class="sc">$</span>EVID<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a> p1 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals</span>(<span class="at">y =</span> <span class="dv">1000</span><span class="sc">+</span>yobs[ktore], <span class="at">yrep =</span> yrepCond1[,ktore], <span class="at">x =</span> yobs[ktore]) <span class="sc">+</span> </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"Observed (ug/mL)"</span>) <span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Individual predictions (ug/mL)"</span>) <span class="sc">+</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"CEFTOLOZANE"</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a> p2 <span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">ppc_intervals</span>(<span class="at">y =</span> <span class="dv">1000</span><span class="sc">+</span>yobs[ktore], <span class="at">yrep =</span> yrepPred1[,ktore], <span class="at">x =</span> yobs[ktore]) <span class="sc">+</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observed (ug/mL)"</span>) <span class="sc">+</span> </span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Population predictions (ug/mL)"</span>) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>ktore <span class="ot">&lt;-</span> xdata<span class="sc">$</span>CMT<span class="sc">==</span><span class="dv">3</span> <span class="sc">&amp;</span> xdata<span class="sc">$</span>EVID<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a> p3 <span class="ot">&lt;-</span> bayesplot<span class="sc">::</span><span class="fu">ppc_intervals</span>(<span class="at">y =</span> <span class="dv">1000</span><span class="sc">+</span>yobs[ktore], <span class="at">yrep =</span> yrepCond1[,ktore], <span class="at">x =</span> yobs[ktore]) <span class="sc">+</span> </span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"Observed (ug/mL)"</span>) <span class="sc">+</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Individual predictions (ug/mL)"</span>) <span class="sc">+</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"TAZOBACTAM"</span>) <span class="sc">+</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span> </span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a> p4 <span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">ppc_intervals</span>(<span class="at">y =</span> <span class="dv">1000</span><span class="sc">+</span>yobs[ktore], <span class="at">yrep =</span> yrepPred1[,ktore], <span class="at">x =</span> yobs[ktore]) <span class="sc">+</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Observed (ug/mL)"</span>) <span class="sc">+</span> </span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">"Population predictions (ug/mL)"</span>) <span class="sc">+</span></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">"grey"</span>, <span class="at">linetype=</span><span class="st">"dotted"</span>)</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a> plotAll <span class="ot">&lt;-</span> (p1<span class="sc">+</span>p3)<span class="sc">/</span>(p2<span class="sc">+</span>p4)</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a> plotAll</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/GOF-stan-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pta" class="level1">
<h1>PTA</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#copy_model_as_stan_gq(mod5)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>mod5gq  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(<span class="fu">file.path</span>(model_dir, <span class="st">"5_gq"</span>))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co">#open_standata_file(mod5)</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co">#check_stan_model(mod5)</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co">#mod5gq_res &lt;- mod5gq %&gt;% submit_model(.overwrite = FALSE) </span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>mod5gq_res  <span class="ot">&lt;-</span> <span class="fu">read_model</span>(<span class="fu">file.path</span>(model_dir, <span class="st">"5_gq"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_fit_model</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"thetaPredC"</span>, <span class="st">"thetaPredT"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>ptab1 <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5gq_res<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"thetaPredC"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(thetaPredC[j, ID]) <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> j, <span class="at">values_from =</span> thetaPredC, <span class="at">names_prefix =</span> <span class="st">"X"</span>) </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>ptab2 <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5gq_res<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"thetaPredT"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(thetaPredT[j, ID])<span class="sc">%&gt;%</span> </span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">j=</span>j<span class="sc">+</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> j, <span class="at">values_from =</span> thetaPredT, <span class="at">names_prefix =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, X6<span class="sc">:</span>X10)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>ptab <span class="ot">=</span> <span class="fu">cbind</span>(ptab1, ptab2) <span class="sc">%&gt;%</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ID =</span> ID...<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, X1<span class="sc">:</span>X10)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>nsubj <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ptab)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="co"># model name and location</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>mod_no <span class="ot">&lt;-</span> <span class="st">"5"</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>dir_mod <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"model/simod/basic"</span>)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>pk_mod <span class="ot">&lt;-</span> mrgsolve<span class="sc">::</span><span class="fu">mread</span>(<span class="fu">file.path</span>(dir_mod, mod_no))</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>presim_data_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>nsubj,</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TIME =</span> <span class="dv">0</span>,</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">EVID =</span> <span class="dv">1</span>,</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">CMT =</span> <span class="dv">1</span>,</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADDL =</span> <span class="dv">21</span>,</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">AMT =</span> <span class="dv">2</span>,</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">II =</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ptab) </span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>presim_data_2<span class="ot">&lt;-</span>presim_data_1 <span class="sc">%&gt;%</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AMT=</span><span class="dv">1</span>, <span class="at">CMT=</span><span class="dv">3</span>)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>presim_data <span class="ot">=</span> <span class="fu">rbind</span>(presim_data_1,presim_data_2)<span class="sc">%&gt;%</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, TIME, CMT)</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>pk_sim_1 <span class="ot">&lt;-</span> <span class="fu">mrgsim_df</span>(pk_mod,</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> presim_data,</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,dt)<span class="sc">+</span><span class="dv">48</span>),</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tad =</span> T,</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a>                    <span class="at">recover =</span> <span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, TIME, <span class="at">TAD=</span>tad, CEF, TAZ) <span class="sc">%&gt;%</span></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dose =</span> <span class="st">"2 mg q8h"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME<span class="sc">&gt;=</span><span class="dv">48</span> <span class="sc">&amp;</span> TIME<span class="sc">&lt;</span><span class="dv">48</span><span class="sc">+</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">MIC =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), <span class="fu">log</span>(<span class="dv">64</span>), <span class="at">h =</span> <span class="dv">64</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC,ID) <span class="sc">%&gt;%</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TARGET =</span> <span class="fu">as.numeric</span>((<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.8</span><span class="sc">*</span>CEF<span class="sc">*</span><span class="dv">1000</span><span class="sc">&gt;=</span>MIC)) <span class="sc">*</span> dt)<span class="sc">&gt;=</span><span class="fl">0.3</span><span class="sc">*</span><span class="dv">8</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC) <span class="sc">%&gt;%</span></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">PTA =</span> <span class="fu">mean</span>(TARGET))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model name and location</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mod_no <span class="ot">&lt;-</span> <span class="st">"5"</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>dir_mod <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">"model/simod/basic"</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>pk_mod <span class="ot">&lt;-</span> mrgsolve<span class="sc">::</span><span class="fu">mread</span>(<span class="fu">file.path</span>(dir_mod, mod_no))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>df_draws <span class="ot">&lt;-</span> posterior<span class="sc">::</span><span class="fu">as_draws_df</span>(mod5gq_res<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"thetaPredC"</span>,<span class="st">"thetaPredT"</span>)))</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>sim_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(i, <span class="at">mod =</span> pk_mod, <span class="at">df =</span> df_draws, .tinf, .dosecef, .dosetaz, <span class="at">.ii =</span> <span class="dv">8</span>) {</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>ptab1 <span class="ot">&lt;-</span> df_draws <span class="sc">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.draw <span class="sc">==</span> i)<span class="sc">%&gt;%</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(thetaPredC[j, ID]) <span class="sc">%&gt;%</span> </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> j, <span class="at">values_from =</span> thetaPredC, <span class="at">names_prefix =</span> <span class="st">"X"</span>) </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>ptab2 <span class="ot">&lt;-</span> df_draws <span class="sc">%&gt;%</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.draw <span class="sc">==</span> i)<span class="sc">%&gt;%</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(thetaPredT[j,ID])<span class="sc">%&gt;%</span> </span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">j=</span>j<span class="sc">+</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> j, <span class="at">values_from =</span> thetaPredT, <span class="at">names_prefix =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, X6<span class="sc">:</span>X10)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>ptab <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ptab1, ptab2) <span class="sc">%&gt;%</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ID =</span> ID...<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, X1<span class="sc">:</span>X10)</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>nsubj <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ptab)</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>presim_data_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>nsubj,</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">TIME =</span> <span class="dv">0</span>,</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">EVID =</span> <span class="dv">1</span>,</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">CMT =</span> <span class="dv">1</span>,</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADDL =</span> <span class="dv">21</span>,</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">AMT =</span> .dosecef,</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">RATE =</span> (.dosecef<span class="sc">/</span>.tinf),</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">II =</span> .ii) <span class="sc">%&gt;%</span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ptab) </span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>presim_data_2 <span class="ot">&lt;-</span> presim_data_1 <span class="sc">%&gt;%</span></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AMT =</span> .dosetaz, </span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>         <span class="at">CMT =</span> <span class="dv">3</span>, </span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE =</span> (.dosetaz<span class="sc">/</span>.tinf))</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>presim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(presim_data_1, presim_data_2)<span class="sc">%&gt;%</span></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, TIME, CMT)</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>pk_sim_1 <span class="ot">&lt;-</span> <span class="fu">mrgsim_df</span>(pk_mod,</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> presim_data,</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, dt) <span class="sc">+</span> <span class="dv">48</span>),</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tad =</span> T,</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">recover =</span> <span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, TIME, <span class="at">TAD =</span> tad, CEF, TAZ) <span class="sc">%&gt;%</span></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME <span class="sc">&gt;=</span> <span class="dv">48</span> <span class="sc">&amp;</span> TIME <span class="sc">&lt;</span> <span class="dv">48</span> <span class="sc">+</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">MIC =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), <span class="fu">log</span>(<span class="dv">64</span>), <span class="at">length.out =</span> <span class="dv">64</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, ID) <span class="sc">%&gt;%</span></span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TARGET1 =</span> (<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.8</span> <span class="sc">*</span> CEF <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">&gt;=</span> MIC)) <span class="sc">*</span> dt) <span class="sc">&gt;=</span> <span class="fl">0.3</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="do">### CEF</span></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">TARGET2 =</span> (<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.7</span> <span class="sc">*</span> TAZ <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">&gt;=</span> <span class="dv">1</span>)) <span class="sc">*</span> dt) <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="do">###TAZ </span></span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC) <span class="sc">%&gt;%</span></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">PTA =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET1 <span class="sc">&amp;</span> TARGET2)),</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">PTAC =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET1)),</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">PTAT =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET2))) <span class="sc">%&gt;%</span></span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">irep =</span> i)</span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="pta-plots" class="level2">
<h2 class="anchored" data-anchor-id="pta-plots">PTA plots</h2>
<section id="pta-of-both-drugs" class="level3">
<h3 class="anchored" data-anchor-id="pta-of-both-drugs">PTA of both drugs</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun, <span class="at">mod =</span> pk_mod, <span class="at">df =</span> df_draws, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>pta_data1 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC) <span class="sc">%&gt;%</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>), </span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">myc =</span> <span class="fu">median</span>(PTAC),</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">hyc =</span> <span class="fu">quantile</span>(PTAC, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">lyc =</span> <span class="fu">quantile</span>(PTAC, <span class="at">probs =</span> <span class="fl">0.05</span>), </span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">myt =</span> <span class="fu">median</span>(PTAT),</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">hyt =</span> <span class="fu">quantile</span>(PTAT, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">lyt =</span> <span class="fu">quantile</span>(PTAT, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>plot_pta1 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata, <span class="fu">aes</span>(<span class="at">x =</span> MIC)) <span class="sc">+</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> my, <span class="at">color =</span> <span class="st">"PTA"</span>)) <span class="sc">+</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> <span class="st">"PTA"</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> myc, <span class="at">color =</span> <span class="st">"PTA-CEF"</span>)) <span class="sc">+</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lyc, <span class="at">ymax =</span> hyc, <span class="at">fill =</span> <span class="st">"PTA-CEF"</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> myt, <span class="at">color =</span> <span class="st">"PTA-TAZ"</span>)) <span class="sc">+</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lyt, <span class="at">ymax =</span> hyt, <span class="at">fill =</span> <span class="st">"PTA-TAZ"</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment"</span>, </span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"PTA"</span> <span class="ot">=</span> <span class="st">"#5A8099"</span>, <span class="st">"PTA-CEF"</span> <span class="ot">=</span> <span class="st">"#3C4F2F"</span>, <span class="st">"PTA-TAZ"</span> <span class="ot">=</span> <span class="st">"#7A3C4A"</span>)) <span class="sc">+</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"PTA"</span> <span class="ot">=</span> <span class="st">"#5A8099"</span>, <span class="st">"PTA-CEF"</span> <span class="ot">=</span> <span class="st">"#3C4F2F"</span>, <span class="st">"PTA-TAZ"</span> <span class="ot">=</span> <span class="st">"#7A3C4A"</span>)) <span class="sc">+</span></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span>  </span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>))</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>pta_all1 <span class="ot">&lt;-</span> <span class="fu">pta_data1</span>(out1)</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta1</span>(pta_all1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20of%20both-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>pta_filtered1 <span class="ot">&lt;-</span> <span class="fu">pta_data1</span>(out1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta1</span>(pta_filtered1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20of%20both-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pta-in-different-time-of-infusion" class="level3">
<h3 class="anchored" data-anchor-id="pta-in-different-time-of-infusion">PTA in different time of infusion</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun, <span class="at">mod =</span> pk_mod, <span class="at">df =</span> df_draws, <span class="at">.tinf =</span> <span class="dv">1</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>out10 <span class="ot">&lt;-</span> out1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"3h, dose = 3g"</span>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>out20 <span class="ot">&lt;-</span> out2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"1h, dose = 3g"</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(out10, out20)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>pta_data2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  </span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, type)<span class="sc">%&gt;%</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>plot_pta2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata) <span class="sc">+</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">color =</span> type, <span class="at">fill =</span> type), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment - time infusion"</span>, </span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3h, dose = 3g"</span> <span class="ot">=</span> <span class="st">"#007F7F"</span>, <span class="st">"1h, dose = 3g"</span> <span class="ot">=</span> <span class="st">"#D95F02"</span>)) <span class="sc">+</span></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3h, dose = 3g"</span> <span class="ot">=</span> <span class="st">"#007F7F"</span>, <span class="st">"1h, dose = 3g"</span> <span class="ot">=</span> <span class="st">"#D95F02"</span>)) <span class="sc">+</span></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>)) </span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>pta_all2 <span class="ot">&lt;-</span> <span class="fu">pta_data2</span>(out)</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta2</span>(pta_all2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20by%20tinf-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pta_filtered2 <span class="ot">&lt;-</span> <span class="fu">pta_data2</span>(out <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta2</span>(pta_filtered2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20by%20tinf-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pta-by-dose-and-time-of-infusion" class="level3">
<h3 class="anchored" data-anchor-id="pta-by-dose-and-time-of-infusion">PTA by dose and time of infusion</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>out3 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun, <span class="at">mod =</span> pk_mod, <span class="at">df =</span> df_draws, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">1</span>, <span class="at">.dosetaz =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>out4 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun, <span class="at">mod =</span> pk_mod, <span class="at">df =</span> df_draws, <span class="at">.tinf =</span> <span class="dv">1</span>, <span class="at">.dosecef =</span> <span class="dv">1</span>, <span class="at">.dosetaz =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>out10 <span class="ot">&lt;-</span> out1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=3h"</span>)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>out20 <span class="ot">&lt;-</span> out2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=1h"</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>out30 <span class="ot">&lt;-</span> out3 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"1.5g q8h, tinf=3h"</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>out40 <span class="ot">&lt;-</span> out4 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"1.5g q8h, tinf=1h"</span>)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(out10, out20, out30, out40)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>pta_data3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  </span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, dose)<span class="sc">%&gt;%</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>plot_pta3 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata) <span class="sc">+</span></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">color =</span> dose, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment - dose"</span>, </span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h"</span> <span class="ot">=</span> <span class="st">"#004545"</span>,<span class="st">"3g q8h tinf=1h"</span> <span class="ot">=</span> <span class="st">"#007F7F"</span>, <span class="st">"1.5g q8h, tinf=3h"</span> <span class="ot">=</span> <span class="st">"#B24D02"</span>, <span class="st">"1.5g q8h, tinf=1h"</span> <span class="ot">=</span> <span class="st">"#C99A47"</span>)) <span class="sc">+</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h"</span> <span class="ot">=</span> <span class="st">"#004545"</span>,<span class="st">"3g q8h tinf=1h"</span> <span class="ot">=</span> <span class="st">"#007F7F"</span>, <span class="st">"1.5g q8h, tinf=3h"</span> <span class="ot">=</span> <span class="st">"#B24D02"</span>, <span class="st">"1.5g q8h, tinf=1h"</span> <span class="ot">=</span> <span class="st">"#C99A47"</span>)) <span class="sc">+</span></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>)) </span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a>pta_all3 <span class="ot">&lt;-</span> <span class="fu">pta_data3</span>(out)</span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta3</span>(pta_all3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20by%20dose-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pta_filtered3 <span class="ot">&lt;-</span> <span class="fu">pta_data3</span>(out <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta3</span>(pta_filtered3)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20by%20dose-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="cmt" class="level2">
<h2 class="anchored" data-anchor-id="cmt">1CMT</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>runno <span class="ot">=</span> <span class="st">"100"</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>nrep <span class="ot">=</span> <span class="dv">500</span> <span class="co"># number of parameter sets </span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>nm_dir <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/basic"</span>)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>nm_mod <span class="ot">&lt;-</span> bbr<span class="sc">::</span><span class="fu">read_model</span>(<span class="fu">file.path</span>(nm_dir, runno))</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' Load the mrgsolve model</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>model_dir <span class="ot">&lt;-</span> <span class="st">"model/simod/basic"</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">mread</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, runno))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="generate-parameter-sets" class="level3">
<h3 class="anchored" data-anchor-id="generate-parameter-sets">Generate parameter sets</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' Generate 500 parameter sets by sampling from variance-covariance matrix for fixed and random effect parameter estimates of the final ppk model</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>set_parset_pk <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">modelName =</span> runno, <span class="at">nsim=</span>nsim){</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  .est <span class="ot">&lt;-</span> mrgsolve<span class="sc">::</span><span class="fu">read_nmext</span>(modelName, <span class="at">project =</span> nm_dir) <span class="co">#retrieves NONMEM estimates for use in the mrgsolve model when $NMEXT or $NMXML is invoked</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  .cov <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="fu">file.path</span>(nm_dir, modelName, <span class="fu">paste0</span>(modelName, <span class="st">".cov"</span>)),</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">skip=</span><span class="dv">1</span>, <span class="at">header=</span>T) <span class="co"># retrieve the full variance-covariance error matrix for THETA, OMEGA and SIGMA</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  .cov<span class="sc">$</span>NAME <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  take <span class="ot">&lt;-</span> <span class="fu">grep</span> (<span class="st">"THETA"</span>, <span class="fu">names</span>(.cov))</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  .cov <span class="ot">&lt;-</span> .cov[take, take] <span class="co"># keeps only the THETAs</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> .est<span class="sc">$</span>param <span class="co">#Get the point estimates of THETAs</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a> <span class="co"># omega &lt;- .est$raw[grepl("OMEGA", names(.est$raw))]</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  omega <span class="ot">&lt;-</span> <span class="fu">as_bmat</span>(.est,<span class="st">"OMEGA"</span>) <span class="co">#Get the estimates of OMEGA matrix</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a> <span class="co"># sigma &lt;- .est$raw[grepl("SIGMA", names(.est$raw))]</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">as_bmat</span>(.est, <span class="st">"SIGMA"</span>) <span class="co">#Get the estimates of SIGMA matrix</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the number of observations and number of subjects</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>  summ <span class="ot">=</span> nm_mod <span class="sc">%&gt;%</span> <span class="fu">model_summary</span>()</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  nObsUsed <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summ<span class="sc">$</span>run_details<span class="sc">$</span>number_of_obs)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  nSubsUsed <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(summ<span class="sc">$</span>run_details<span class="sc">$</span>number_of_subjects)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create Parameters for Simulation with Uncertainty</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>  pkparset <span class="ot">&lt;-</span> <span class="fu">simpar</span>(<span class="at">nsim=</span>nsim, </span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>                 <span class="at">digits=</span><span class="dv">5</span>, </span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">theta=</span><span class="fu">unlist</span>(theta), </span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cov=</span>.cov, </span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">omega=</span>omega,</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sigma=</span>sigma, </span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">odf=</span>nSubsUsed,</span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sdf=</span><span class="fu">floor</span>((nSubsUsed <span class="sc">+</span> nObsUsed)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (pkparset)</span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>pkparset <span class="ot">&lt;-</span> <span class="fu">set_parset_pk</span>(<span class="at">modelName =</span> runno, <span class="at">nsim=</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rep=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) </span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> pkparset <span class="sc">%&gt;%</span></span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"TH</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">"THETA"</span>, .x), <span class="fu">starts_with</span>(<span class="st">"TH."</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"OM"</span>, <span class="st">"OMEGA"</span>, .x), <span class="fu">starts_with</span>(<span class="st">"OM"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"SG"</span>, <span class="st">"SIGMA"</span>, .x), <span class="fu">starts_with</span>(<span class="st">"SG"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, .x), <span class="fu">starts_with</span>(<span class="st">"OM"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">""</span>, .x), <span class="fu">starts_with</span>(<span class="st">"SI"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="fu">row_number</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>sim_fun_1cmt <span class="ot">&lt;-</span> <span class="cf">function</span>(i, <span class="at">mod =</span> mod, <span class="at">df =</span> post, .tinf, .dosecef, .dosetaz, <span class="at">.ii =</span> <span class="dv">8</span>) {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>ptab <span class="ot">&lt;-</span> df[i,]</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>Omega <span class="ot">=</span> <span class="fu">as_bmat</span>(<span class="fu">list</span>(<span class="at">OMEGA1.1=</span>ptab<span class="sc">$</span>OMEGA11,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA2.1=</span>ptab<span class="sc">$</span>OMEGA21,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA2.2=</span>ptab<span class="sc">$</span>OMEGA22,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA3.1=</span>ptab<span class="sc">$</span>OMEGA31, </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA3.2=</span>ptab<span class="sc">$</span>OMEGA32, </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA3.3=</span>ptab<span class="sc">$</span>OMEGA33), <span class="st">"OMEGA"</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>nsubj <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>presim_data_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>nsubj,</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">TIME =</span> <span class="dv">0</span>,</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">EVID =</span> <span class="dv">1</span>,</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">CMT =</span> <span class="dv">1</span>,</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADDL =</span> <span class="dv">21</span>,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">AMT =</span> .dosecef,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">RATE =</span> (.dosecef<span class="sc">/</span>.tinf),</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">II =</span> .ii) </span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>presim_data_2 <span class="ot">&lt;-</span> presim_data_1 <span class="sc">%&gt;%</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AMT =</span> .dosetaz, </span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">CMT =</span> <span class="dv">3</span>, </span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE =</span> (.dosetaz<span class="sc">/</span>.tinf))</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>presim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(presim_data_1, presim_data_2)<span class="sc">%&gt;%</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, TIME, CMT)</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">=</span> mod <span class="sc">%&gt;%</span> <span class="fu">omat</span>(Omega) <span class="sc">%&gt;%</span> <span class="fu">update</span>(<span class="at">param =</span> <span class="fu">list</span>(<span class="at">THETA1 =</span> ptab<span class="sc">$</span>THETA1,</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA2 =</span> ptab<span class="sc">$</span>THETA2,</span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA3 =</span> ptab<span class="sc">$</span>THETA3,</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA4 =</span> ptab<span class="sc">$</span>THETA4,</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA5 =</span> ptab<span class="sc">$</span>THETA5))</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>pk_sim_1 <span class="ot">&lt;-</span> <span class="fu">mrgsim_df</span>(mod,</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> presim_data,</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, dt) <span class="sc">+</span> <span class="dv">48</span>),</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tad =</span> T,</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">recover =</span> <span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, TIME, <span class="at">TAD =</span> tad, CEF, TAZ) <span class="sc">%&gt;%</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME <span class="sc">&gt;=</span> <span class="dv">48</span> <span class="sc">&amp;</span> TIME <span class="sc">&lt;</span> <span class="dv">48</span> <span class="sc">+</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">MIC =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), <span class="fu">log</span>(<span class="dv">64</span>), <span class="at">length.out =</span> <span class="dv">64</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, ID) <span class="sc">%&gt;%</span></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TARGET1 =</span> (<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.8</span> <span class="sc">*</span> CEF <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">&gt;=</span> MIC)) <span class="sc">*</span> dt) <span class="sc">&gt;=</span> <span class="fl">0.3</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="do">### CEF</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>            <span class="at">TARGET2 =</span> (<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.7</span> <span class="sc">*</span> TAZ <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">&gt;=</span> <span class="dv">1</span>)) <span class="sc">*</span> dt) <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="do">###TAZ </span></span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC) <span class="sc">%&gt;%</span></span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">PTA =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET1 <span class="sc">&amp;</span> TARGET2)),</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">PTAC =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET1)),</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>            <span class="at">PTAT =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET2))) <span class="sc">%&gt;%</span></span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">irep =</span> i)</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="pta-plots-1" class="level2">
<h2 class="anchored" data-anchor-id="pta-plots-1">PTA plots</h2>
<section id="pta-of-3g-drugs-by-type-of-analysis" class="level3">
<h3 class="anchored" data-anchor-id="pta-of-3g-drugs-by-type-of-analysis">PTA of 3g drugs by type of analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>out1cmt1 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun_1cmt, <span class="at">mod =</span> mod, <span class="at">df =</span> post, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>out2cmt1 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun_1cmt, <span class="at">mod =</span> mod, <span class="at">df =</span> post, <span class="at">.tinf =</span> <span class="dv">1</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>out10 <span class="ot">&lt;-</span> out1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=3h BAYES"</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>out20 <span class="ot">&lt;-</span> out2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=1h BAYES"</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>out30 <span class="ot">&lt;-</span> out1cmt1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=3h 1CMT"</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>out40 <span class="ot">&lt;-</span> out2cmt1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=1h 1CMT"</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(out10, out20, out30, out40)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>pta_data4 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, dose)<span class="sc">%&gt;%</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>plot_pta4 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata) <span class="sc">+</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">color =</span> dose, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment - dose"</span>, </span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h BAYES"</span> <span class="ot">=</span> <span class="st">"#004545"</span>,<span class="st">"3g q8h tinf=1h BAYES"</span> <span class="ot">=</span> <span class="st">"#007F7F"</span>, <span class="st">"3g q8h tinf=3h 1CMT"</span> <span class="ot">=</span> <span class="st">"#3A2E4D"</span>, <span class="st">"3g q8h tinf=1h 1CMT"</span> <span class="ot">=</span> <span class="st">"#675A82"</span>)) <span class="sc">+</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h BAYES"</span> <span class="ot">=</span> <span class="st">"#004545"</span>,<span class="st">"3g q8h tinf=1h BAYES"</span> <span class="ot">=</span> <span class="st">"#007F7F"</span>, <span class="st">"3g q8h tinf=3h 1CMT"</span> <span class="ot">=</span> <span class="st">"#3A2E4D"</span>, <span class="st">"3g q8h tinf=1h 1CMT"</span> <span class="ot">=</span> <span class="st">"#675A82"</span>)) <span class="sc">+</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>),</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow=</span><span class="dv">2</span>)) </span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>pta_all4 <span class="ot">&lt;-</span> <span class="fu">pta_data4</span>(out)</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta4</span>(pta_all4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/compare%20PTAs-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pta_filtered4 <span class="ot">&lt;-</span> <span class="fu">pta_data4</span>(out <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta4</span>(pta_filtered4)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/compare%20PTAs-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pta-in-tinf-12h-by-type-of-analysis" class="level3">
<h3 class="anchored" data-anchor-id="pta-in-tinf-12h-by-type-of-analysis">PTA in tinf = 12h by type of analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>out6bayes <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun, <span class="at">mod =</span> pk_mod, <span class="at">df =</span> df_draws, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>, <span class="at">.ii =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>out7cmt1 <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun_1cmt, <span class="at">mod =</span> mod, <span class="at">df =</span> post, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>, <span class="at">.ii =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>out60 <span class="ot">&lt;-</span> out6bayes <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q12h tinf=3h BAYES"</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>out70 <span class="ot">&lt;-</span> out7cmt1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q12h tinf=3h 1CMT"</span>)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(out60, out70)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>pta_data5 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  </span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, dose)<span class="sc">%&gt;%</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>plot_pta5 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata) <span class="sc">+</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">color =</span> dose, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment - dose"</span>, </span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h BAYES"</span> <span class="ot">=</span> <span class="st">"#5A2E3A"</span>,<span class="st">"3g q12h tinf=3h 1CMT"</span> <span class="ot">=</span> <span class="st">"#2F4A3D"</span>)) <span class="sc">+</span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h BAYES"</span> <span class="ot">=</span> <span class="st">"#5A2E3A"</span>,<span class="st">"3g q12h tinf=3h 1CMT"</span> <span class="ot">=</span> <span class="st">"#2F4A3D"</span>)) <span class="sc">+</span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>))</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>pta_all5 <span class="ot">&lt;-</span> <span class="fu">pta_data5</span>(out)</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta5</span>(pta_all5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20tinf%2012h-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>pta_filtered5 <span class="ot">&lt;-</span> <span class="fu">pta_data5</span>(out <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta5</span>(pta_filtered5)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20tinf%2012h-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="bootstrap" class="level1">
<h1>Bootstrap</h1>
<section id="cmt-1" class="level2">
<h2 class="anchored" data-anchor-id="cmt-1">1CMT</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>BS_DIR <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/bootstrap/bs"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>BS_DATA_DIR <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(BS_DIR, <span class="st">"data"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(BS_DIR)) <span class="fu">dir.create</span>(BS_DIR)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(BS_DATA_DIR)) <span class="fu">dir.create</span>(BS_DATA_DIR)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>template_ctl <span class="ot">&lt;-</span> <span class="fu">readLines</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.path</span>(BS_DIR, <span class="st">"100bs.mod"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>RUN <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">500</span>) </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>nmdata <span class="ot">&lt;-</span> xdata</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>make_boot_run <span class="ot">&lt;-</span> <span class="cf">function</span>(n, data, template, boot_dir, <span class="at">strat_cols =</span> <span class="cn">NULL</span>, </span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">overwrite =</span> <span class="cn">FALSE</span>,  <span class="at">seed =</span> <span class="dv">123456</span>){</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Created {n} bootstrap data sets"</span>))</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  mod_name <span class="ot">&lt;-</span> <span class="fu">str_pad</span>(<span class="fu">paste0</span>(n), <span class="at">width=</span><span class="dv">3</span>, <span class="at">pad=</span><span class="st">"0"</span>)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  mod_path <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{boot_dir}/{mod_name}"</span>)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">file.exists</span>(<span class="fu">paste0</span>(mod_path, <span class="st">".yaml"</span>)) <span class="sc">&amp;&amp;</span> <span class="sc">!</span>overwrite) {</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">read_model</span>(mod_path))</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    data_new <span class="ot">&lt;-</span> <span class="fu">resample_df</span>(</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>     data,</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">key_cols =</span> <span class="st">"ID"</span>,</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">strat_cols =</span> strat_cols)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>  data_new <span class="ot">&lt;-</span> <span class="fu">rename</span>(data_new, <span class="at">OID =</span> ID, <span class="at">ID =</span> KEY)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>  data_new <span class="ot">&lt;-</span> <span class="fu">select</span>(data_new, <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">names</span>(data), <span class="st">"OID"</span>)))</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>  csv_file <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{boot_dir}/data/{mod_name}.csv"</span>)</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fwrite</span>(data_new, csv_file , <span class="at">na =</span> <span class="st">'.'</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span> )</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>  new_ctl <span class="ot">&lt;-</span> <span class="fu">whisker.render</span>(template, <span class="fu">list</span>(<span class="at">run_num =</span> mod_name))</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_file</span>(new_ctl, <span class="at">file =</span> <span class="fu">paste0</span>(mod_path, <span class="st">".ctl"</span>))</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">new_model</span>(</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>    mod_path,</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.description =</span> <span class="fu">glue</span>(<span class="st">"bootstrap {mod_name}"</span>), </span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">.overwrite =</span> overwrite)</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>  mod</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>  RUN, </span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> nmdata, </span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> make_boot_run, </span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">template =</span> template_ctl, </span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_dir =</span> BS_DIR, </span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">strat_cols =</span> <span class="cn">NULL</span>,</span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">FALSE</span> <span class="co">#set TRUE to run models and create datasets</span></span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#bbi.yaml file needs to be in bs folder</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>heavt_comp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">bbr.bbi_exe_path =</span> <span class="st">"C:/Users/pauoku/AppData/Roaming/bbi/bbi.exe"</span>)  <span class="do">### need to be changed to your directory</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> bbr<span class="sc">::</span><span class="fu">submit_models</span>(</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  models[x],</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">.config_path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/bootstrap/bs/bbi.yaml"</span>),</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">.bbi_args =</span> <span class="fu">list</span>(<span class="at">overwrite =</span> F, <span class="at">threads =</span> <span class="dv">1</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="do">########### NEED TO BE RUN IF YOU WANT TO CHECK #############</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="co"># cl &lt;- makeCluster(detectCores())</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># clusterExport(cl, "models")</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="co"># results_par &lt;- parLapply(cl, RUN, heavt_comp)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="summary-of-parameter-estimates" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-parameter-estimates">Summary of parameter estimates:</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">param_estimates_batch</span>(BS_DIR)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>err <span class="ot">&lt;-</span> <span class="fu">filter</span>(boot, <span class="sc">!</span><span class="fu">is.na</span>(error_msg))</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(err)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="generate-parameter-sets-1" class="level3">
<h3 class="anchored" data-anchor-id="generate-parameter-sets-1">Generate parameter sets</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> boot <span class="sc">%&gt;%</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)|,"</span>, <span class="st">""</span>, .x), <span class="fu">starts_with</span>(<span class="st">"OMEGA"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)|,"</span>, <span class="st">""</span>, .x), <span class="fu">starts_with</span>(<span class="st">"SIGMA"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(error_msg, termination_code, absolute_model_path))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>sim_fun_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(i, <span class="at">mod =</span> mod, <span class="at">df =</span> post, .tinf, .dosecef, .dosetaz, <span class="at">.ii =</span> <span class="dv">8</span>) {</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>ptab <span class="ot">&lt;-</span> df[i,]</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>omega_values <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    ptab<span class="sc">$</span>OMEGA11, ptab<span class="sc">$</span>OMEGA21, ptab<span class="sc">$</span>OMEGA22,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    ptab<span class="sc">$</span>OMEGA31, ptab<span class="sc">$</span>OMEGA32, ptab<span class="sc">$</span>OMEGA33</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(omega_values))) {</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">"Missing OMEGA values for iteration "</span>, i)</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>) </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>Omega <span class="ot">=</span> <span class="fu">as_bmat</span>(<span class="fu">list</span>(<span class="at">OMEGA1.1=</span>ptab<span class="sc">$</span>OMEGA11,</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA2.1=</span>ptab<span class="sc">$</span>OMEGA21,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA2.2=</span>ptab<span class="sc">$</span>OMEGA22,</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA3.1=</span>ptab<span class="sc">$</span>OMEGA31, </span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA3.2=</span>ptab<span class="sc">$</span>OMEGA32, </span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">OMEGA3.3=</span>ptab<span class="sc">$</span>OMEGA33), <span class="st">"OMEGA"</span>)</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>omega_det <span class="ot">&lt;-</span> <span class="fu">det</span>(Omega)</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(omega_det) <span class="sc">||</span> omega_det <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">"Invalid Omega matrix: determinant is NA or &lt;= 0 for iteration "</span>, i)</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>) </span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>nsubj <span class="ot">&lt;-</span> <span class="dv">250</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>presim_data_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span>nsubj,</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">TIME =</span> <span class="dv">0</span>,</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">EVID =</span> <span class="dv">1</span>,</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">CMT =</span> <span class="dv">1</span>,</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">ADDL =</span> <span class="dv">21</span>,</span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">AMT =</span> .dosecef,</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">RATE =</span> (.dosecef<span class="sc">/</span>.tinf),</span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">II =</span> .ii) </span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>presim_data_2 <span class="ot">&lt;-</span> presim_data_1 <span class="sc">%&gt;%</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AMT =</span> .dosetaz, </span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">CMT =</span> <span class="dv">3</span>, </span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">RATE =</span> (.dosetaz<span class="sc">/</span>.tinf))</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>presim_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(presim_data_1, presim_data_2)<span class="sc">%&gt;%</span></span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID, TIME, CMT)</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">=</span> mod <span class="sc">%&gt;%</span> <span class="fu">omat</span>(Omega) <span class="sc">%&gt;%</span> <span class="fu">update</span>(<span class="at">param =</span> <span class="fu">list</span>(<span class="at">THETA1 =</span> ptab<span class="sc">$</span>THETA1,</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA2 =</span> ptab<span class="sc">$</span>THETA2,</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA3 =</span> ptab<span class="sc">$</span>THETA3,</span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA4 =</span> ptab<span class="sc">$</span>THETA4,</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">THETA5 =</span> ptab<span class="sc">$</span>THETA5))</span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(<span class="fu">det</span>(Omega) <span class="sc">&lt;=</span> <span class="dv">0</span>, <span class="cn">NA</span>, <span class="fu">det</span>(Omega))</span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>pk_sim_1 <span class="ot">&lt;-</span> <span class="fu">mrgsim_df</span>(mod,</span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> presim_data,</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a>                    <span class="at">add =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, dt) <span class="sc">+</span> <span class="dv">48</span>),</span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a>                    <span class="at">tad =</span> T,</span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a>                    <span class="at">recover =</span> <span class="st">"ID"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, TIME, <span class="at">TAD =</span> tad, CEF, TAZ) <span class="sc">%&gt;%</span></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TIME <span class="sc">&gt;=</span> <span class="dv">48</span> <span class="sc">&amp;</span> TIME <span class="sc">&lt;</span> <span class="dv">48</span> <span class="sc">+</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">MIC =</span> <span class="fu">exp</span>(<span class="fu">seq</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), <span class="fu">log</span>(<span class="dv">64</span>), <span class="at">length.out =</span> <span class="dv">64</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, ID) <span class="sc">%&gt;%</span></span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TARGET1 =</span> (<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.8</span> <span class="sc">*</span> CEF <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">&gt;=</span> MIC)) <span class="sc">*</span> dt) <span class="sc">&gt;=</span> <span class="fl">0.3</span> <span class="sc">*</span> <span class="dv">8</span>, <span class="do">### CEF</span></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">TARGET2 =</span> (<span class="fu">length</span>(<span class="fu">which</span>(<span class="fl">0.7</span> <span class="sc">*</span> TAZ <span class="sc">*</span> <span class="dv">1000</span> <span class="sc">&gt;=</span> <span class="dv">1</span>)) <span class="sc">*</span> dt) <span class="sc">&gt;=</span> <span class="fl">0.2</span> <span class="sc">*</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="do">### TAZ </span></span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC) <span class="sc">%&gt;%</span></span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">PTA =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET1 <span class="sc">&amp;</span> TARGET2)),</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">PTAC =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET1)),</span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">PTAT =</span> <span class="fu">mean</span>(<span class="fu">as.numeric</span>(TARGET2))) <span class="sc">%&gt;%</span></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">irep =</span> i)</span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="params-table" class="level3">
<h3 class="anchored" data-anchor-id="params-table">Params table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>calc_stats <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  mean_val <span class="ot">&lt;-</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  sd_val <span class="ot">&lt;-</span> <span class="fu">sd</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># 95% CI</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  rse <span class="ot">&lt;-</span> sd_val <span class="sc">/</span> mean_val</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  cv <span class="ot">&lt;-</span> (sd_val <span class="sc">/</span> mean_val) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tibble</span>(</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean =</span> <span class="fu">round</span>(mean_val, <span class="dv">3</span>),</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">round</span>(sd_val, <span class="dv">3</span>),</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95%CI Lower</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci[<span class="dv">1</span>], <span class="dv">3</span>),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95%CI Upper</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(ci[<span class="dv">2</span>], <span class="dv">3</span>),</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSE =</span> <span class="fu">round</span>(rse, <span class="dv">3</span>),</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">CV%</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(cv, <span class="dv">3</span>)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 16
  run   THETA1 THETA2 THETA3 THETA4 THETA5 SIGMA11 SIGMA21 SIGMA22 OMEGA11
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 001     30.5   6.10   51.8   14.2  0.879  0.0477       0  0.0673  0.0500
2 002     27.7   6.82   50.4   15.3  0.845  0.0525       0  0.0693  0.138 
3 003     21.2   5.38   34.7   11.5  0.888  0.0426       0  0.0751  0.0672
4 004     29.1   5.32   57.1   14.5  0.689  0.0353       0  0.0703  0.0507
5 005     31.1   6.07   46.6   13.3  0.841  0.0516       0  0.0664  0.107 
6 006     27.7   5.04   48.5   13.4  0.780  0.0331       0  0.0640  0.0931
# ℹ 6 more variables: OMEGA21 &lt;dbl&gt;, OMEGA22 &lt;dbl&gt;, OMEGA31 &lt;dbl&gt;,
#   OMEGA32 &lt;dbl&gt;, OMEGA33 &lt;dbl&gt;, iter &lt;int&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>model_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/basic"</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>model_run <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="fu">yaml_as_df</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, model_run, <span class="st">"parm.yaml"</span>))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(post) <span class="sc">%&gt;%</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"THETA"</span>), <span class="fu">starts_with</span>(<span class="st">"OMEGA"</span>), <span class="fu">starts_with</span>(<span class="st">"SIGMA"</span>))</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>params_long <span class="ot">&lt;-</span> params_df <span class="sc">%&gt;%</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"name"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(key, <span class="at">by =</span> <span class="st">"name"</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> params_long <span class="sc">%&gt;%</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, abb, panel) <span class="sc">%&gt;%</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_raw =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_raw =</span> <span class="fu">sd</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_raw =</span> <span class="fu">quantile</span>(Value, <span class="fl">0.025</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_raw =</span> <span class="fu">quantile</span>(Value, <span class="fl">0.975</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSE_raw =</span> SD_raw <span class="sc">/</span> Mean_raw <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(Mean_raw, <span class="dv">2</span>),</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>    panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(Mean_raw, <span class="dv">4</span>),</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(Mean_raw, <span class="dv">3</span>)),</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(SD_raw, <span class="dv">2</span>),</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(SD_raw, <span class="dv">4</span>),</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(SD_raw, <span class="dv">3</span>)),</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(Lower_raw, <span class="dv">2</span>),</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(Lower_raw, <span class="dv">4</span>),</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(Lower_raw, <span class="dv">3</span>)),</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(Upper_raw, <span class="dv">2</span>),</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(Upper_raw, <span class="dv">4</span>),</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(Upper_raw, <span class="dv">3</span>)),</span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSE =</span> <span class="fu">case_when</span>(</span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(RSE_raw, <span class="dv">2</span>),</span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(RSE_raw, <span class="dv">4</span>),</span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(RSE_raw, <span class="dv">3</span>)),</span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"["</span>, Lower, <span class="st">", "</span>, Upper, <span class="st">"]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">type =</span> panel, <span class="at">Parameter =</span> abb, Mean, SD, <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, RSE) <span class="sc">%&gt;%</span></span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a>panel_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"struct"</span>, <span class="st">"IIV"</span>, <span class="st">"RV"</span>)</span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> param_df <span class="sc">%&gt;%</span></span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> panel_order)) <span class="sc">%&gt;%</span></span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(type, Parameter)</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a>png_table <span class="ot">&lt;-</span> param_df <span class="sc">%&gt;%</span></span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>() <span class="sc">%&gt;%</span></span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_panel</span>(<span class="st">"type"</span>, <span class="at">duplicates_ok =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_center</span>(<span class="at">Parameter =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_image</span>()</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a>png_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/bs1cmt%20params-1.png" class="img-fluid figure-img" width="304"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="pta-final-plots" class="level2">
<h2 class="anchored" data-anchor-id="pta-final-plots">PTA final plots</h2>
<section id="pta-in-tinf-8h-by-type-of-analysis" class="level3">
<h3 class="anchored" data-anchor-id="pta-in-tinf-8h-by-type-of-analysis">PTA in tinf = 8h by type of analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>out1boot <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun_boot, <span class="at">mod =</span> mod, <span class="at">df =</span> post, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>, <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>out10 <span class="ot">&lt;-</span> out1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=3h 2CMT BAYES"</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>out30 <span class="ot">&lt;-</span> out1cmt1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=3h 1CMT COVARIANCE"</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>out50 <span class="ot">&lt;-</span> out1boot <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q8h tinf=3h 1CMT BOOTSTRAP"</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(out10, out30, out50)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>pta_data6 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  </span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, dose)<span class="sc">%&gt;%</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>statistics <span class="ot">&lt;-</span> out <span class="sc">%&gt;%</span> </span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dose, irep) <span class="sc">%&gt;%</span>  </span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MIC90=</span><span class="fu">interp1</span>(PTA, MIC, .<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dose) <span class="sc">%&gt;%</span>  </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(MIC90),</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(MIC90, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(MIC90, <span class="at">probs =</span> <span class="fl">0.05</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>statistics</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  dose                              my    hy    ly
  &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 3g q8h tinf=3h 1CMT BOOTSTRAP   21.9  31.8  16.3
2 3g q8h tinf=3h 1CMT COVARIANCE  20.1  26.4  13.4
3 3g q8h tinf=3h 2CMT BAYES       27.0  31.1  21.8</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>plot_pta6 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">color =</span> dose, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment - 3g q8h"</span>, </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"#3A5F2F"</span>, <span class="st">"3g q8h tinf=3h 1CMT COVARIANCE"</span> <span class="ot">=</span> <span class="st">"#7A1C2B"</span>, <span class="st">"3g q8h tinf=3h 1CMT BOOTSTRAP"</span> <span class="ot">=</span> <span class="st">"#E6B12C"</span>)) <span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"#3A5F2F"</span>, <span class="st">"3g q8h tinf=3h 1CMT COVARIANCE"</span> <span class="ot">=</span> <span class="st">"#7A1C2B"</span>, <span class="st">"3g q8h tinf=3h 1CMT BOOTSTRAP"</span> <span class="ot">=</span> <span class="st">"#E6B12C"</span>)) <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>), <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="co">#+</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a> <span class="co"># guides(fill = guide_legend(nrow = 2),</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a> <span class="co">#        color = guide_legend(nrow=2))</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>pta_all6 <span class="ot">&lt;-</span> <span class="fu">pta_data6</span>(out)</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta6</span>(pta_all6)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/q8h%20pta%20plot-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>pta_filtered6 <span class="ot">&lt;-</span> <span class="fu">pta_data6</span>(out <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta6</span>(pta_filtered6)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/q8h%20pta%20plot-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>plot_pta_facet <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  doses_plot1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h 2CMT BAYES"</span>,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3g q8h tinf=3h 1CMT COVARIANCE"</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  doses_plot2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h 2CMT BAYES"</span>,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3g q8h tinf=3h 1CMT BOOTSTRAP"</span>)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">%in%</span> doses_plot1) <span class="sc">%&gt;%</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="fu">str_replace</span>(dose, <span class="st">" tinf=3h "</span>, <span class="st">" tinf=3h</span><span class="sc">\n</span><span class="st">"</span>))  </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">%in%</span> doses_plot2) <span class="sc">%&gt;%</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="fu">str_replace</span>(dose, <span class="st">" tinf=3h "</span>, <span class="st">" tinf=3h</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df1) <span class="sc">+</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>) <span class="sc">+</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># labs(title = "Probability of target attainment - 3g q8h",</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      subtitle = "CEFTOLOZANE: %fT MIC of 30%\nTAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml",</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      x = "MIC", y = "PTA") +</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT COVARIANCE"</span><span class="ot">=</span><span class="st">"#7A1C2B"</span>),</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT COVARIANCE"</span><span class="ot">=</span><span class="st">"#7A1C2B"</span>),</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) </span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>   plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2) <span class="sc">+</span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>) <span class="sc">+</span></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>     <span class="co"># labs(title = "Probability of target attainment - 3g q8h",</span></span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>     <span class="co">#      subtitle = "CEFTOLOZANE: %fT MIC of 30%\nTAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml",</span></span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a>     <span class="co">#      x = "MIC", y = "PTA") +</span></span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT BOOTSTRAP"</span><span class="ot">=</span><span class="st">"#E6B12C"</span>),</span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q8h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT BOOTSTRAP"</span><span class="ot">=</span><span class="st">"#E6B12C"</span>),</span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb97-43"><a href="#cb97-43" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb97-44"><a href="#cb97-44" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) </span>
<span id="cb97-45"><a href="#cb97-45" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb97-46"><a href="#cb97-46" aria-hidden="true" tabindex="-1"></a> combined <span class="ot">&lt;-</span> (plot1 <span class="sc">|</span> plot2) <span class="sc">&amp;</span>        </span>
<span id="cb97-47"><a href="#cb97-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb97-48"><a href="#cb97-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Probability of Target Attainment - 3g q8h"</span>,</span>
<span id="cb97-49"><a href="#cb97-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>) <span class="sc">&amp;</span></span>
<span id="cb97-50"><a href="#cb97-50" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb97-51"><a href="#cb97-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb97-52"><a href="#cb97-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray20"</span>),</span>
<span id="cb97-53"><a href="#cb97-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">&amp;</span> <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb97-54"><a href="#cb97-54" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb97-55"><a href="#cb97-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined) </span>
<span id="cb97-56"><a href="#cb97-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-57"><a href="#cb97-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-58"><a href="#cb97-58" aria-hidden="true" tabindex="-1"></a>sumdata <span class="ot">&lt;-</span> <span class="fu">pta_data6</span>(out)</span>
<span id="cb97-59"><a href="#cb97-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-60"><a href="#cb97-60" aria-hidden="true" tabindex="-1"></a>pta_all_facet <span class="ot">&lt;-</span> <span class="fu">plot_pta_facet</span>(sumdata)</span>
<span id="cb97-61"><a href="#cb97-61" aria-hidden="true" tabindex="-1"></a>pta_all_facet</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/q8h%20pta%20plot%20facet-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pta_filtered_facet <span class="ot">&lt;-</span> <span class="fu">plot_pta_facet</span>(sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>pta_filtered_facet</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/q8h%20pta%20plot%20facet-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pta-in-tinf-12h-by-type-of-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="pta-in-tinf-12h-by-type-of-analysis-1">PTA in tinf = 12h by type of analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">12</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>out2boot <span class="ot">&lt;-</span> <span class="fu">future_map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">250</span>, sim_fun_boot, <span class="at">mod =</span> mod, <span class="at">df =</span> post, <span class="at">.tinf =</span> <span class="dv">3</span>, <span class="at">.dosecef =</span> <span class="dv">2</span>, <span class="at">.dosetaz =</span> <span class="dv">1</span>, <span class="at">.ii =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>()</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>out60 <span class="ot">&lt;-</span> out6bayes <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q12h tinf=3h 2CMT BAYES"</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>out70 <span class="ot">&lt;-</span> out7cmt1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>out80 <span class="ot">&lt;-</span> out2boot <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span>)</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span>  <span class="fu">rbind</span>(out60, out70, out80)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>pta_data7 <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span>  </span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(MIC, dose)<span class="sc">%&gt;%</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(PTA),</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(PTA, <span class="at">probs =</span> <span class="fl">0.05</span>))</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>statistics <span class="ot">&lt;-</span> out <span class="sc">%&gt;%</span> </span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dose, irep) <span class="sc">%&gt;%</span>  </span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MIC90=</span><span class="fu">interp1</span>(PTA, MIC, .<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dose) <span class="sc">%&gt;%</span>  </span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">my =</span> <span class="fu">median</span>(MIC90),</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">hy =</span> <span class="fu">quantile</span>(MIC90, <span class="at">probs =</span> <span class="fl">0.95</span>),</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">ly =</span> <span class="fu">quantile</span>(MIC90, <span class="at">probs =</span> <span class="fl">0.05</span>))  <span class="sc">%&gt;%</span> </span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x,<span class="dv">2</span>)))</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>statistics</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  dose                               my    hy    ly
  &lt;chr&gt;                           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 3g q12h tinf=3h 1CMT BOOTSTRAP   20.0  27.5  15.2
2 3g q12h tinf=3h 1CMT COVARIANCE  18.0  23.6  12.6
3 3g q12h tinf=3h 2CMT BAYES       24.3  27.7  20.2</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>plot_pta7 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sumdata) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">color =</span> dose, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Probability of target attainment - 3g q12h"</span>, </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>, </span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>)  <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"#3A5F2F"</span>, <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span> <span class="ot">=</span> <span class="st">"#7A1C2B"</span>, <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span> <span class="ot">=</span> <span class="st">"#E6B12C"</span>)) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"#3A5F2F"</span>, <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span> <span class="ot">=</span> <span class="st">"#7A1C2B"</span>, <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span> <span class="ot">=</span> <span class="st">"#E6B12C"</span>)) <span class="sc">+</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray20"</span>),  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))  </span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>pta_all7 <span class="ot">&lt;-</span> <span class="fu">pta_data7</span>(out)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta7</span>(pta_all7)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20tinf%2012h%20bs-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>pta_filtered7 <span class="ot">&lt;-</span> <span class="fu">pta_data7</span>(out <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_pta7</span>(pta_filtered7)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/PTA%20tinf%2012h%20bs-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>plot_pta_facet2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  doses_plot1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span>,</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  doses_plot2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span>,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">%in%</span> doses_plot1) <span class="sc">%&gt;%</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="fu">str_replace</span>(dose, <span class="st">" tinf=3h "</span>, <span class="st">" tinf=3h</span><span class="sc">\n</span><span class="st">"</span>))  </span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">%in%</span> doses_plot2) <span class="sc">%&gt;%</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dose =</span> <span class="fu">str_replace</span>(dose, <span class="st">" tinf=3h "</span>, <span class="st">" tinf=3h</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df1) <span class="sc">+</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>) <span class="sc">+</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># labs(title = "Probability of target attainment - 3g q12h",</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      subtitle = "CEFTOLOZANE: %fT MIC of 30%\nTAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml",</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#      x = "MIC", y = "PTA") +</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,  </span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT COVARIANCE"</span><span class="ot">=</span><span class="st">"#7A1C2B"</span>),</span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT COVARIANCE"</span><span class="ot">=</span><span class="st">"#7A1C2B"</span>),</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span>  </span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) </span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>   plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2) <span class="sc">+</span></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>) <span class="sc">+</span></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>     <span class="co"># labs(title = "Probability of target attainment - 3g q12h",</span></span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a>     <span class="co">#      subtitle = "CEFTOLOZANE: %fT MIC of 30%\nTAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml",</span></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a>     <span class="co">#      x = "MIC", y = "PTA") +</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT BOOTSTRAP"</span><span class="ot">=</span><span class="st">"#E6B12C"</span>),</span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span> </span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT BOOTSTRAP"</span><span class="ot">=</span><span class="st">"#E6B12C"</span>),</span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>,<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>))</span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a> combined <span class="ot">&lt;-</span> (plot1 <span class="sc">|</span> plot2) <span class="sc">&amp;</span>        </span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Probability of Target Attainment - 3g q12h"</span>,</span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>) <span class="sc">&amp;</span></span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, </span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray20"</span>),</span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">&amp;</span>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb103-55"><a href="#cb103-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined) </span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a>sumdata <span class="ot">&lt;-</span> <span class="fu">pta_data7</span>(out)</span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a>pta_all_facet2 <span class="ot">&lt;-</span> <span class="fu">plot_pta_facet2</span>(sumdata)</span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a>pta_all_facet2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/q12h%20pta%20plot%20facet-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>pta_filtered_facet2 <span class="ot">&lt;-</span> <span class="fu">plot_pta_facet2</span>(sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(MIC <span class="sc">&gt;</span> <span class="dv">4</span>))</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>pta_filtered_facet2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/q12h%20pta%20plot%20facet-2.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>plot_pta_facet2 <span class="ot">&lt;-</span> <span class="cf">function</span>(sumdata) {</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  doses_plot1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span>)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  doses_plot2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span>)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">%in%</span> doses_plot1)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> sumdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dose <span class="sc">%in%</span> doses_plot2)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df1) <span class="sc">+</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>) <span class="sc">+</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span><span class="ot">=</span><span class="st">"#7A1C2B"</span>),</span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span>,</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT COVARIANCE"</span>),</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span><span class="ot">=</span><span class="st">"#7A1C2B"</span>),</span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span>,</span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q12h tinf=3h 1CMT COVARIANCE"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT COVARIANCE"</span>),</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>  plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2) <span class="sc">+</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">y =</span> my, <span class="at">color =</span> dose)) <span class="sc">+</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> MIC, <span class="at">ymin =</span> ly, <span class="at">ymax =</span> hy, <span class="at">fill =</span> dose), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">'grey30'</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> </span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MIC"</span>, <span class="at">y =</span> <span class="st">"PTA"</span>) <span class="sc">+</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span><span class="ot">=</span><span class="st">"#E6B12C"</span>),</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span>,</span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT BOOTSTRAP"</span>),</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span><span class="ot">=</span><span class="st">"#3A5F2F"</span>,</span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span><span class="ot">=</span><span class="st">"#E6B12C"</span>),</span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"3g q12h tinf=3h 2CMT BAYES"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">2CMT BAYES"</span>,</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"3g q12h tinf=3h 1CMT BOOTSTRAP"</span> <span class="ot">=</span> <span class="st">"3g q12h tinf=3h</span><span class="sc">\n</span><span class="st">1CMT BOOTSTRAP"</span>),</span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">transform =</span> <span class="st">"log2"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>)) <span class="sc">+</span></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> (plot1 <span class="sc">|</span> plot2) <span class="sc">&amp;</span></span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_annotation</span>(</span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Probability of Target Attainment - 3g q12h"</span>,</span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"CEFTOLOZANE: %fT MIC of 30%</span><span class="sc">\n</span><span class="st">TAZOBACTAM: %fT CT of 20% for a CT of 1 ug/ml"</span>) <span class="sc">&amp;</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray20"</span>),</span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)) <span class="sc">&amp;</span></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>),</span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">&amp;</span></span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(combined)</span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="cmt-2" class="level2">
<h2 class="anchored" data-anchor-id="cmt-2">2CMT</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>BS_DIR <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/bootstrap/bs102"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>BS_DATA_DIR <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(BS_DIR, <span class="st">"data"</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(BS_DIR)) <span class="fu">dir.create</span>(BS_DIR)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(BS_DATA_DIR)) <span class="fu">dir.create</span>(BS_DATA_DIR)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>template_ctl <span class="ot">&lt;-</span> <span class="fu">readLines</span>(</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.path</span>(BS_DIR, <span class="st">"102bs.mod"</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>RUN <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">500</span>) </span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>nmdata <span class="ot">&lt;-</span> xdata</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>make_boot_run <span class="ot">&lt;-</span> <span class="cf">function</span>(n, data, template, boot_dir, <span class="at">strat_cols =</span> <span class="cn">NULL</span>, </span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">overwrite =</span> <span class="cn">FALSE</span>,  <span class="at">seed =</span> <span class="dv">123456</span>){</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">%%</span> <span class="dv">10</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Created {n} bootstrap data sets"</span>))</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>  mod_name <span class="ot">&lt;-</span> <span class="fu">str_pad</span>(<span class="fu">paste0</span>(n), <span class="at">width=</span><span class="dv">3</span>, <span class="at">pad=</span><span class="st">"0"</span>)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>  mod_path <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{boot_dir}/{mod_name}"</span>)</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">file.exists</span>(<span class="fu">paste0</span>(mod_path, <span class="st">".yaml"</span>)) <span class="sc">&amp;&amp;</span> <span class="sc">!</span>overwrite) {</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">read_model</span>(mod_path))</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>    data_new <span class="ot">&lt;-</span> <span class="fu">resample_df</span>(</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>     data,</span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">key_cols =</span> <span class="st">"ID"</span>,</span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">strat_cols =</span> strat_cols)</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>  data_new <span class="ot">&lt;-</span> <span class="fu">rename</span>(data_new, <span class="at">OID =</span> ID, <span class="at">ID =</span> KEY)</span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>  data_new <span class="ot">&lt;-</span> <span class="fu">select</span>(data_new, <span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">names</span>(data), <span class="st">"OID"</span>)))</span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>  csv_file <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{boot_dir}/data/{mod_name}.csv"</span>)</span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fwrite</span>(data_new, csv_file , <span class="at">na =</span> <span class="st">'.'</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span> )</span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>  new_ctl <span class="ot">&lt;-</span> <span class="fu">whisker.render</span>(template, <span class="fu">list</span>(<span class="at">run_num =</span> mod_name))</span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_file</span>(new_ctl, <span class="at">file =</span> <span class="fu">paste0</span>(mod_path, <span class="st">".ctl"</span>))</span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">new_model</span>(</span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a>    mod_path,</span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">.description =</span> <span class="fu">glue</span>(<span class="st">"bootstrap {mod_name}"</span>), </span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">.overwrite =</span> overwrite)</span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a>  mod</span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-48"><a href="#cb106-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-49"><a href="#cb106-49" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb106-50"><a href="#cb106-50" aria-hidden="true" tabindex="-1"></a>  RUN, </span>
<span id="cb106-51"><a href="#cb106-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> nmdata, </span>
<span id="cb106-52"><a href="#cb106-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> make_boot_run, </span>
<span id="cb106-53"><a href="#cb106-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">template =</span> template_ctl, </span>
<span id="cb106-54"><a href="#cb106-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">boot_dir =</span> BS_DIR, </span>
<span id="cb106-55"><a href="#cb106-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">strat_cols =</span> <span class="cn">NULL</span>,</span>
<span id="cb106-56"><a href="#cb106-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">FALSE</span> <span class="co">#set TRUE to run models and create datasets</span></span>
<span id="cb106-57"><a href="#cb106-57" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bbi.yaml file needs to be in boot folder</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># out &lt;- submit_models(</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   models,</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   .config_path = here("model/nonmem/basic/bbi.yaml"),</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   .bbi_args = list(overwrite = T, threads = 1)</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>heavt_comp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">bbr.bbi_exe_path =</span> <span class="st">"C:/Users/pauoku/AppData/Roaming/bbi/bbi.exe"</span>)</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> bbr<span class="sc">::</span><span class="fu">submit_models</span>(</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  models[x],</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">.config_path =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/bootstrap/bs102/bbi.yaml"</span>),</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">.bbi_args =</span> <span class="fu">list</span>(<span class="at">overwrite =</span> F, <span class="at">threads =</span> <span class="dv">1</span>)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a><span class="do">########### NEED TO BE RUN IF YOU WANT TO CHECK #############</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a><span class="co"># cl &lt;- makeCluster(detectCores())</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="co"># clusterExport(cl, "models")</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a><span class="co"># results_par &lt;- parLapply(cl, RUN, heavt_comp)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="summary-of-parameter-estimates-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-parameter-estimates-1">Summary of parameter estimates:</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>boot <span class="ot">&lt;-</span> <span class="fu">param_estimates_batch</span>(BS_DIR)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>err <span class="ot">&lt;-</span> <span class="fu">filter</span>(boot, <span class="sc">!</span><span class="fu">is.na</span>(error_msg))</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(err)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="generate-parameter-sets-2" class="level3">
<h3 class="anchored" data-anchor-id="generate-parameter-sets-2">Generate parameter sets</h3>
</section>
<section id="params-table-1" class="level3">
<h3 class="anchored" data-anchor-id="params-table-1">Params table</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>model_dir <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"model/nonmem/basic"</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>model_run <span class="ot">&lt;-</span> <span class="dv">102</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="fu">yaml_as_df</span>(here<span class="sc">::</span><span class="fu">here</span>(model_dir, model_run, <span class="st">"parm.yaml"</span>))</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(post) </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>params_df <span class="ot">&lt;-</span> params_df <span class="sc">%&gt;%</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"THETA"</span>), <span class="fu">starts_with</span>(<span class="st">"OMEGA"</span>), <span class="fu">starts_with</span>(<span class="st">"SIGMA"</span>))</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>num_theta8_removed <span class="ot">&lt;-</span> <span class="fu">sum</span>(params_df<span class="sc">$</span>THETA8 <span class="sc">&gt;</span> <span class="dv">2000</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>num_theta3_removed <span class="ot">&lt;-</span> <span class="fu">sum</span>(params_df<span class="sc">$</span>THETA3 <span class="sc">&gt;</span> <span class="dv">700</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>num_theta8_removed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>num_theta3_removed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>params_long <span class="ot">&lt;-</span> params_df <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"name"</span>, <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(key, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(name <span class="sc">==</span> <span class="st">"THETA8"</span> <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="dv">2000</span>)) <span class="sc">%&gt;%</span> <span class="do">###remove values &gt;2000 </span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(name <span class="sc">==</span> <span class="st">"THETA3"</span> <span class="sc">&amp;</span> Value <span class="sc">&gt;</span> <span class="dv">700</span>)) <span class="do">###remove values &gt;700 </span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> params_long <span class="sc">%&gt;%</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, abb, panel) <span class="sc">%&gt;%</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_raw =</span> <span class="fu">mean</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD_raw =</span> <span class="fu">sd</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower_raw =</span> <span class="fu">quantile</span>(Value, <span class="fl">0.025</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper_raw =</span> <span class="fu">quantile</span>(Value, <span class="fl">0.975</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSE_raw =</span> SD_raw <span class="sc">/</span> Mean_raw <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">Mean =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(Mean_raw, <span class="dv">2</span>),</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(Mean_raw, <span class="dv">4</span>),</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(Mean_raw, <span class="dv">3</span>)),</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">SD =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(SD_raw, <span class="dv">2</span>),</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(SD_raw, <span class="dv">4</span>),</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(SD_raw, <span class="dv">3</span>)),</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">Lower =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(Lower_raw, <span class="dv">2</span>),</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(Lower_raw, <span class="dv">4</span>),</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(Lower_raw, <span class="dv">3</span>)),</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">Upper =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(Upper_raw, <span class="dv">2</span>),</span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(Upper_raw, <span class="dv">4</span>),</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(Upper_raw, <span class="dv">3</span>)),</span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">RSE =</span> <span class="fu">case_when</span>(</span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"THETA"</span>, name) <span class="sc">~</span> <span class="fu">round</span>(RSE_raw, <span class="dv">2</span>),</span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>      panel <span class="sc">==</span> <span class="st">"RV"</span> <span class="sc">~</span> <span class="fu">round</span>(RSE_raw, <span class="dv">4</span>),</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">round</span>(RSE_raw, <span class="dv">3</span>)),</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"["</span>, Lower, <span class="st">", "</span>, Upper, <span class="st">"]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">type =</span> panel, <span class="at">Parameter =</span> abb, Mean, SD, <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, RSE) <span class="sc">%&gt;%</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>panel_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"struct"</span>, <span class="st">"IIV"</span>, <span class="st">"RV"</span>)</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>param_df <span class="ot">&lt;-</span> param_df <span class="sc">%&gt;%</span></span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">levels =</span> panel_order)) <span class="sc">%&gt;%</span></span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(type, Parameter)</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>png_table <span class="ot">&lt;-</span> param_df <span class="sc">%&gt;%</span></span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_new</span>() <span class="sc">%&gt;%</span></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_panel</span>(<span class="st">"type"</span>, <span class="at">duplicates_ok =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_center</span>(<span class="at">Parameter =</span> <span class="st">"l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_image</span>()</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>png_table</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ceftaz-analysis-bayes_stan_files/figure-html/bs2cmt%20params-1.png" class="img-fluid figure-img" width="304"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session Info</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 11 x64 (build 26200)

Matrix products: default


locale:
[1] LC_COLLATE=Polish_Poland.utf8  LC_CTYPE=Polish_Poland.utf8   
[3] LC_MONETARY=Polish_Poland.utf8 LC_NUMERIC=C                  
[5] LC_TIME=Polish_Poland.utf8    

time zone: Europe/Warsaw
tzcode source: internal

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] posterior_1.6.1      conflicted_1.2.0     PKNCA_0.11.0        
 [4] MESS_0.5.12          simpar_0.1.1         rlang_1.1.4         
 [7] furrr_0.3.1          future_1.68.0        tidybayes_3.0.7.9000
[10] loo_2.8.0            magick_2.8.5         yaml_2.3.8          
[13] magrittr_2.0.3       cowplot_1.1.3        gridExtra_2.3       
[16] cmdstanr_0.8.1.9000  nmrec_0.4.0          pmtables_0.6.0.9000 
[19] scales_1.3.0         here_1.0.1           whisker_0.4.1       
[22] glue_1.7.0           stable_1.1.6         rmutil_1.1.10       
[25] lubridate_1.9.3      forcats_1.0.0        stringr_1.5.1       
[28] purrr_1.0.2          readr_2.1.5          tidyr_1.3.1         
[31] tibble_3.2.1         tidyverse_2.0.0      data.table_1.16.2   
[34] knitr_1.49           naniar_1.1.0         pmplots_0.4.0.9001  
[37] vpc_1.2.2            mrggsave_0.4.5.9000  mrgsolve_1.5.2.9000 
[40] patchwork_1.3.0      ggplot2_3.5.1        dplyr_1.1.4         
[43] bayesplot_1.11.1     bbr.bayes_0.2.0      bbr_1.10.0          
[46] pracma_2.4.4        

loaded via a namespace (and not attached):
 [1] RColorBrewer_1.1-3   geeM_0.10.1          tensorA_0.36.2.1    
 [4] rstudioapi_0.17.1    jsonlite_1.8.8       farver_2.1.2        
 [7] rmarkdown_2.29       geepack_1.3.12       fs_1.6.4            
[10] ragg_1.3.3           vctrs_0.6.5          memoise_2.0.1       
[13] askpass_1.2.1        htmltools_0.5.8.1    distributional_0.5.0
[16] haven_2.5.4          broom_1.0.7          gridGraphics_0.5-1  
[19] parallelly_1.45.1    KernSmooth_2.23-24   htmlwidgets_1.6.4   
[22] pdftools_3.4.1       plyr_1.8.9           cachem_1.1.0        
[25] lifecycle_1.0.4      pkgconfig_2.0.3      Matrix_1.6-1.1      
[28] R6_2.6.1             fastmap_1.2.0        digest_0.6.37       
[31] colorspace_2.1-0     GGally_2.2.1         ps_1.7.6            
[34] rprojroot_2.0.4      textshaping_0.4.0    labeling_0.4.3      
[37] timechange_0.3.0     mgcv_1.9-1           abind_1.4-8         
[40] compiler_4.3.2       proxy_0.4-27         bit64_4.5.2         
[43] withr_3.0.2          backports_1.4.1      ggstats_0.7.0       
[46] MASS_7.3-60          classInt_0.4-10      tools_4.3.2         
[49] visdat_0.6.0         clipr_0.8.0          nlme_3.1-164        
[52] grid_4.3.2           ggformula_0.12.0     checkmate_2.3.1     
[55] reshape2_1.4.4       generics_0.1.3       diffobj_0.3.5       
[58] gtable_0.3.6         labelled_2.13.0      tzdb_0.4.0          
[61] class_7.3-22         hms_1.1.3            utf8_1.2.4          
[64] pillar_1.10.2        ggdist_3.3.2         vroom_1.6.5         
[67] splines_4.3.2        lattice_0.22-6       renv_1.0.7          
[70] bit_4.5.0.1          tidyselect_1.2.1     arrayhelpers_1.1-0  
[73] xfun_0.49            mosaicCore_0.9.4.0   matrixStats_1.4.1   
[76] stringi_1.8.4        qpdf_1.3.4           evaluate_1.0.1      
[79] codetools_0.2-20     cli_3.6.3            systemfonts_1.1.0   
[82] munsell_0.5.1        processx_3.8.4       Rcpp_1.0.12         
[85] globals_0.18.0       coda_0.19-4.1        png_0.1-8           
[88] svUnit_1.0.6         assertthat_0.2.1     listenv_0.9.1       
[91] e1071_1.7-16         ggridges_0.5.6       crayon_1.5.3        </code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>